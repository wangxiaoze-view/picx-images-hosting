!function(e,t){"object"==typeof exports&&"undefined"!=typeof module?module.exports=t():"function"==typeof define&&define.amd?define(t):(e="undefined"!=typeof globalThis?globalThis:e||self).logReporting=t()}(this,function(){"use strict";function b(e,s,i,c){return new(i=i||Promise)(function(r,t){function n(e){try{a(c.next(e))}catch(e){t(e)}}function o(e){try{a(c.throw(e))}catch(e){t(e)}}function a(e){var t;e.done?r(e.value):((t=e.value)instanceof i?t:new i(function(e){e(t)})).then(n,o)}a((c=c.apply(e,s||[])).next())})}function A(e){return e&&e.__esModule&&Object.prototype.hasOwnProperty.call(e,"default")?e.default:e}var w,u,h,p,g,m,I,k,f,C,M,T,N,R,s,i,O,L,W,l,y,r,V;w="millisecond",u="second",h="minute",p="hour",g="day",m="week",I="month",k="quarter",f="year",C="date",M="Invalid Date",T=/^(\d{4})[-/]?(\d{1,2})?[-/]?(\d{0,2})[Tt\s]*(\d{1,2})?:?(\d{1,2})?:?(\d{1,2})?[.:]?(\d+)?$/,N=/\[([^\]]+)]|Y{1,4}|M{1,4}|D{1,2}|d{1,4}|H{1,2}|h{1,2}|a|A|m{1,2}|s{1,2}|Z{1,2}|SSS/g,S={name:"en",weekdays:"Sunday_Monday_Tuesday_Wednesday_Thursday_Friday_Saturday".split("_"),months:"January_February_March_April_May_June_July_August_September_October_November_December".split("_"),ordinal:function(e){var t=["th","st","nd","rd"],r=e%100;return"["+e+(t[(r-20)%10]||t[r]||t[0])+"]"}},o={s:R=function(e,t,r){var n=String(e);return!n||n.length>=t?e:""+Array(t+1-n.length).join(r)+e},z:function(e){var e=-e.utcOffset(),t=Math.abs(e),r=Math.floor(t/60),t=t%60;return(e<=0?"+":"-")+R(r,2,"0")+":"+R(t,2,"0")},m:function e(t,r){var n,o,a;return t.date()<r.date()?-e(r,t):(n=12*(r.year()-t.year())+(r.month()-t.month()),a=r-(o=t.clone().add(n,I))<0,t=t.clone().add(n+(a?-1:1),I),+(-(n+(r-o)/(a?o-t:t-o))||0))},a:function(e){return e<0?Math.ceil(e)||0:Math.floor(e)},p:function(e){return{M:I,y:f,w:m,d:g,D:C,h:p,m:h,s:u,ms:w,Q:k}[e]||String(e||"").toLowerCase().replace(/s$/,"")},u:function(e){return void 0===e}},(i={})[s="en"]=S,O="$isDayjsObject",L=function(e){return e instanceof r||!(!e||!e[O])},l=function(e,t){return L(e)?e.clone():((t="object"==typeof t?t:{}).date=e,t.args=arguments,new r(t))},(y=o).l=W=function e(t,r,n){var o;if(!t)return s;if("string"==typeof t){var a=t.toLowerCase(),r=(i[a]&&(o=a),r&&(i[a]=r,o=a),t.split("-"));if(!o&&1<r.length)return e(r[0])}else{a=t.name;i[a]=t,o=a}return!n&&o&&(s=o),o||!n&&s},y.i=L,y.w=function(e,t){return l(e,{locale:t.$L,utc:t.$u,x:t.$x,$offset:t.$offset})},r=function(){function e(e){this.$L=W(e.locale,null,!0),this.parse(e),this.$x=this.$x||e.x||{},this[O]=!0}var t=e.prototype;return t.parse=function(a){this.$d=function(){var e=a.date,t=a.utc;if(null===e)return new Date(NaN);if(y.u(e))return new Date;if(!(e instanceof Date||"string"!=typeof e||/Z$/i.test(e))){var r,n,o=e.match(T);if(o)return r=o[2]-1||0,n=(o[7]||"0").substring(0,3),t?new Date(Date.UTC(o[1],r,o[3]||1,o[4]||0,o[5]||0,o[6]||0,n)):new Date(o[1],r,o[3]||1,o[4]||0,o[5]||0,o[6]||0,n)}return new Date(e)}(),this.init()},t.init=function(){var e=this.$d;this.$y=e.getFullYear(),this.$M=e.getMonth(),this.$D=e.getDate(),this.$W=e.getDay(),this.$H=e.getHours(),this.$m=e.getMinutes(),this.$s=e.getSeconds(),this.$ms=e.getMilliseconds()},t.$utils=function(){return y},t.isValid=function(){return!(this.$d.toString()===M)},t.isSame=function(e,t){e=l(e);return this.startOf(t)<=e&&e<=this.endOf(t)},t.isAfter=function(e,t){return l(e)<this.startOf(t)},t.isBefore=function(e,t){return this.endOf(t)<l(e)},t.$g=function(e,t,r){return y.u(e)?this[t]:this.set(r,e)},t.unix=function(){return Math.floor(this.valueOf()/1e3)},t.valueOf=function(){return this.$d.getTime()},t.startOf=function(e,t){function r(e,t){return t=y.w(o.$u?Date.UTC(o.$y,t,e):new Date(o.$y,t,e),o),a?t:t.endOf(g)}function n(e,t){return y.w(o.toDate()[e].apply(o.toDate("s"),(a?[0,0,0,0]:[23,59,59,999]).slice(t)),o)}var o=this,a=!!y.u(t)||t,t=y.p(e),s=this.$W,i=this.$M,c=this.$D,l="set"+(this.$u?"UTC":"");switch(t){case f:return a?r(1,0):r(31,11);case I:return a?r(1,i):r(0,i+1);case m:var d=this.$locale().weekStart||0,d=(s<d?s+7:s)-d;return r(a?c-d:c+(6-d),i);case g:case C:return n(l+"Hours",0);case p:return n(l+"Minutes",1);case h:return n(l+"Seconds",2);case u:return n(l+"Milliseconds",3);default:return this.clone()}},t.endOf=function(e){return this.startOf(e,!1)},t.$set=function(e,t){var e=y.p(e),r="set"+(this.$u?"UTC":""),r=((n={}).day=r+"Date",n[C]=r+"Date",n[I]=r+"Month",n[f]=r+"FullYear",n[p]=r+"Hours",n[h]=r+"Minutes",n[u]=r+"Seconds",n[w]=r+"Milliseconds",n[e]),n=e===g?this.$D+(t-this.$W):t;return e===I||e===f?((t=this.clone().set(C,1)).$d[r](n),t.init(),this.$d=t.set(C,Math.min(this.$D,t.daysInMonth())).$d):r&&this.$d[r](n),this.init(),this},t.set=function(e,t){return this.clone().$set(e,t)},t.get=function(e){return this[y.p(e)]()},t.add=function(r,e){function t(e){var t=l(n);return y.w(t.date(t.date()+Math.round(e*r)),n)}var n=this,e=(r=Number(r),y.p(e));return e===I?this.set(I,this.$M+r):e===f?this.set(f,this.$y+r):e===g?t(1):e===m?t(7):(e={minute:6e4,hour:36e5,second:1e3}[e]||1,e=this.$d.getTime()+r*e,y.w(e,this))},t.subtract=function(e,t){return this.add(-1*e,t)},t.format=function(e){var o,r,n,a,s,i,c,l,d,u,h=this,p=this.$locale();return this.isValid()?(o=e||"YYYY-MM-DDTHH:mm:ssZ",r=y.z(this),n=this.$H,a=this.$m,s=this.$M,i=p.weekdays,c=p.months,e=p.meridiem,l=function(e,t,r,n){return e&&(e[t]||e(h,o))||r[t].slice(0,n)},d=function(e){return y.s(n%12||12,e,"0")},u=e||function(e,t,r){e=e<12?"AM":"PM";return r?e.toLowerCase():e},o.replace(N,function(e,t){return t||function(){switch(e){case"YY":return String(h.$y).slice(-2);case"YYYY":return y.s(h.$y,4,"0");case"M":return s+1;case"MM":return y.s(s+1,2,"0");case"MMM":return l(p.monthsShort,s,c,3);case"MMMM":return l(c,s);case"D":return h.$D;case"DD":return y.s(h.$D,2,"0");case"d":return String(h.$W);case"dd":return l(p.weekdaysMin,h.$W,i,2);case"ddd":return l(p.weekdaysShort,h.$W,i,3);case"dddd":return i[h.$W];case"H":return String(n);case"HH":return y.s(n,2,"0");case"h":return d(1);case"hh":return d(2);case"a":return u(n,a,!0);case"A":return u(n,a,!1);case"m":return String(a);case"mm":return y.s(a,2,"0");case"s":return String(h.$s);case"ss":return y.s(h.$s,2,"0");case"SSS":return y.s(h.$ms,3,"0");case"Z":return r}return null}()||r.replace(":","")})):p.invalidDate||M},t.utcOffset=function(){return 15*-Math.round(this.$d.getTimezoneOffset()/15)},t.diff=function(e,t,r){function n(){return y.m(a,s)}var o,a=this,t=y.p(t),s=l(e),i=6e4*(s.utcOffset()-this.utcOffset()),c=this-s;switch(t){case f:o=n()/12;break;case I:o=n();break;case k:o=n()/3;break;case m:o=(c-i)/6048e5;break;case g:o=(c-i)/864e5;break;case p:o=c/36e5;break;case h:o=c/6e4;break;case u:o=c/1e3;break;default:o=c}return r?o:y.a(o)},t.daysInMonth=function(){return this.endOf(I).$D},t.$locale=function(){return i[this.$L]},t.locale=function(e,t){var r;return e?(r=this.clone(),(e=W(e,t,!0))&&(r.$L=e),r):this.$L},t.clone=function(){return y.w(this.$d,this)},t.toDate=function(){return new Date(this.valueOf())},t.toJSON=function(){return this.isValid()?this.toISOString():null},t.toISOString=function(){return this.$d.toISOString()},t.toString=function(){return this.$d.toUTCString()},e}(),V=r.prototype,l.prototype=V,[["$ms",w],["$s",u],["$m",h],["$H",p],["$W",g],["$M",I],["$y",f],["$D",C]].forEach(function(t){V[t[1]]=function(e){return this.$g(e,t[0],t[1])}}),l.extend=function(e,t){return e.$i||(e(t,r,l),e.$i=!0),l},l.locale=W,l.isDayjs=L,l.unix=function(e){return l(1e3*e)},l.en=i[s],l.Ls=i,l.p={};var U,Z=A(l);let B;function G(e){return(e||"").split("\n").slice(1).map(e=>e.replace(/^\s+at\s+/g,"")).join("~~")}function c(e,t={}){var r,n=B;let o,a=0,s=0;return e.stack&&(r=e.stack.match(/at\s+(.+):(\d+):(\d+)/),o=r[1],a=r[2],s=r[3]),Object.assign({type:"Error",eventType:e.type,errorType:"Axios Error",timeStamp:Math.round(e.timeStamp),isTrusted:e.isTrusted,time:Date.now(),path:n.target?n.target.outerHTML:"",nodeName:n.target.nodeName,message:"",stack:G(e.stack||""),filename:o,colno:Number(s),lineno:Number(a)},t)}function e(e){return e in navigator?navigator[e]:"璇ユ祻瑙堝櫒涓嶆敮鎸�!"}function Y(){return Object.assign({title:document.title,url:location.href,date:Z(Date.now()).format("YYYY-MM-DD"),dateTime:Z(Date.now()).format("YYYY-MM-DD HH:mm:ss"),snapshot:JSON.stringify(v.snapshot)},{platform:e("platform"),appName:e("appName"),appVersion:e("appVersion"),appCodeName:e("appCodeName"),vendor:e("vendor"),userAgent:e("userAgent"),onLine:e("onLine"),language:e("language"),product:e("product"),productSub:e("productSub"),windowWidth:window.screen.width,windowHeight:window.screen.height,colorDepth:window.screen.colorDepth})}function d(e){var t=Y(),t=Object.assign(Object.assign({},t),e);navigator.sendBeacon(v.getConfigValue("sdn"),JSON.stringify(t))}function _(e){requestIdleCallback(()=>{var t=document.head,r=document.querySelectorAll("head link[rel=stylesheet]");for(let e=0;e<r.length;e++){var n=r[e],o=(n.setAttribute("cross-origin","anonymous"),n.cloneNode());o.setAttribute("cross-origin","anonymous"),t.removeChild(n),t.appendChild(o)}})}function $(e){e=function(e,t={}){var r=B;let n,o,a=0,s=0,i="";var c,l=e.reason;return"string"==typeof l?n=l:"object"==typeof l&&(n=l.message,l.stack&&(c=l.stack.match(/at\s+(.+):(\d+):(\d+)/),o=c[1],a=c[2],s=c[3]),i=G(l.stack)),Object.assign({type:"Error",eventType:e.type,errorType:"Promise Error",timeStamp:Math.round(e.timeStamp),isTrusted:e.isTrusted,time:Date.now(),path:r.target?r.target.outerHTML:"",nodeName:r.target.nodeName,message:n,stack:i,filename:o,colno:Number(a),lineno:Number(s)},t)}(e);d(e),v.console("error","Promise鐩稿叧閿欒!",e)}function ee(e){var t,r;e.cancelable?(t=e,r=B,d(r={type:"Error",eventType:t.type,errorType:"JS Error",timeStamp:Math.round(t.timeStamp),isTrusted:t.isTrusted,time:Date.now(),path:r.target?r.target.outerHTML:"",nodeName:r.target.nodeName,message:t.message,stack:G(t.error.stack),filename:t.filename,colno:t.colno,lineno:t.lineno}),v.console("error","JS閫昏緫閿欒, 璇锋鏌ラ€昏緫鏄惁姝ｇ‘!",r)):v.watchSource&&(r=(t=e).target,d(e={type:"Error",eventType:t.type,errorType:"Resource Error",timeStamp:Math.round(t.timeStamp),isTrusted:t.isTrusted,time:Date.now(),path:r.src||r.href,nodeName:r.nodeName}),v.console("error","璧勬簮鍔犺浇澶辫触, 璇锋鏌ヨ祫婧愬湴鍧€鏄惁寮曞叆姝ｇ‘!",e))}function te(e){"load"===e?window.addEventListener("load",_):"js"===e&&(window.removeEventListener("unhandledrejection",$),window.removeEventListener("error",ee))}["click","touchstart","mousedown","keydown","mouseover"].forEach(e=>{document.addEventListener(e,e=>{B=e},{capture:!0,passive:!0})});const re=XMLHttpRequest.prototype.send,ne=XMLHttpRequest.prototype.open,oe=window.fetch;function ae(){{const s={src:"",method:"",duration:0,triggerTime:0};XMLHttpRequest.prototype.open=function(e,t){return s.method=e,s.src=t,ne.call(this,e,t,!0)},XMLHttpRequest.prototype.send=function(a){return this.addEventListener("readystatechange",e=>{var{readyState:t,status:r,responseText:n,statusText:o}=this;4===t&&(r<200||300<=r)&&(d(t=c(e,{method:s.method.toUpperCase(),path:s.src,status:r,response:n,params:a?JSON.stringify(a):"",message:o})),v.console("error","Axios鐩稿叧閿欒!",t))}),this.addEventListener("error",e=>{e=c(e,{method:s.method.toUpperCase(),path:s.src,status:this.status,response:this.response?JSON.stringify(this.response):"",params:a?JSON.stringify(a):"",message:this.statusText});d(e),v.console("error","Axios鐩稿叧閿欒!",e)},!1),this.addEventListener("abort",e=>{e=c(e,{method:s.method.toUpperCase(),path:s.src,status:this.status,response:this.response?JSON.stringify(this.response):"",params:a?JSON.stringify(a):"",message:this.statusText});d(e),v.console("error","Axios鐩稿叧閿欒!",e)},!1),re.call(this,a)}}oe&&(window.fetch=function(r,a={}){const{method:s="GET"}=a;var e=oe(r,a);return e.then(t=>{const{url:r,status:n,statusText:o}=t;(n<200||300<=n)&&(console.log(t,111),t.text().then(e=>{e={method:s,path:r,status:n,response:e,params:a.body||"",message:o,errorType:"Fetch Error"},e=c({eventType:t.type,timeStamp:Date.now()},e);d(e),v.console("error","Fetch鐩稿叧閿欒!",e)}))},e=>{var t={method:s,path:r.toString(),status:"500",response:e.message,params:a.body||"",message:"fetchError",errorType:"Fetch Error"},e=c(Object.assign(Object.assign({},e),{type:"",isTrusted:!1,timeStamp:Date.now()}),t);d(e),v.console("error","Fetch鐩稿叧閿欒!",e)}),e})}function se(e){var t=null==e?void 0:e.host;return Boolean((null==t?void 0:t.shadowRoot)===e)}function ie(e){return"[object ShadowRoot]"===Object.prototype.toString.call(e)}function ce(e){try{var t=e.rules||e.cssRules;return t?r=(r=Array.from(t).map(le).join("")).includes(" background-clip: text;")&&!r.includes(" -webkit-background-clip: text;")?r.replace(" background-clip: text;"," -webkit-background-clip: text; background-clip: text;"):r:null}catch(e){return null}var r}function le(e){var t=e.cssText;if("styleSheet"in e)try{t=ce(e.styleSheet)||t}catch(e){}return t}(S=U=U||{})[S.Document=0]="Document",S[S.DocumentType=1]="DocumentType",S[S.Element=2]="Element",S[S.Text=3]="Text",S[S.CDATA=4]="CDATA",S[S.Comment=5]="Comment";t.prototype.getId=function(e){return e&&null!=(e=null==(e=this.getMeta(e))?void 0:e.id)?e:-1},t.prototype.getNode=function(e){return this.idNodeMap.get(e)||null},t.prototype.getIds=function(){return Array.from(this.idNodeMap.keys())},t.prototype.getMeta=function(e){return this.nodeMetaMap.get(e)||null},t.prototype.removeNodeFromMap=function(e){var t=this,r=this.getId(e);this.idNodeMap.delete(r),e.childNodes&&e.childNodes.forEach(function(e){return t.removeNodeFromMap(e)})},t.prototype.has=function(e){return this.idNodeMap.has(e)},t.prototype.hasNode=function(e){return this.nodeMetaMap.has(e)},t.prototype.add=function(e,t){var r=t.id;this.idNodeMap.set(r,e),this.nodeMetaMap.set(e,t)},t.prototype.replace=function(e,t){var r=this.getNode(e);r&&(r=this.nodeMetaMap.get(r))&&this.nodeMetaMap.set(t,r),this.idNodeMap.set(e,t)},t.prototype.reset=function(){this.idNodeMap=new Map,this.nodeMetaMap=new WeakMap};var de=t;function t(){this.idNodeMap=new Map,this.nodeMetaMap=new WeakMap}function ue(e){var t=e.maskInputOptions,r=e.tagName,n=e.type,o=e.value,e=e.maskInputFn,o=o||"";return o=t[r.toLowerCase()]||t[n]?e?e(o):"*".repeat(o.length):o}var he="__rrweb_original__";var K,pe,ge=1,me=new RegExp("[^a-z0-9-_:]"),Ie=-2;function fe(){return ge++}var Ce=/url\((?:(')([^']*)'|(")(.*?)"|([^)]*))\)/gm,ye=/^(?!www\.|(?:http|ftp)s?:\/\/|[A-Za-z]:\\|\/\/|#).*/,Se=/^(data:)([^,]*),(.*)/i;function ve(e,d){return(e||"").replace(Ce,function(e,t,r,n,o,a){r=r||o||a,o=t||n||"";if(!r)return e;if(!ye.test(r))return"url(".concat(o).concat(r).concat(o,")");if(Se.test(r))return"url(".concat(o).concat(r).concat(o,")");if("/"===r[0])return"url(".concat(o).concat((-1<(a=d).indexOf("//")?a.split("/").slice(0,3).join("/"):a.split("/")[0]).split("?")[0]+r).concat(o,")");var s=d.split("/"),t=r.split("/");s.pop();for(var i=0,c=t;i<c.length;i++){var l=c[i];"."!==l&&(".."===l?s.pop():s.push(l))}return"url(".concat(o).concat(s.join("/")).concat(o,")")})}var be=/^[^ \t\n\r\u000c]+/,Ae=/^[, \t\n\r\u000c]+/;function we(e,t){return t&&""!==t.trim()?((e=e.createElement("a")).href=t,e.href):t}function ke(){var e=document.createElement("a");return e.href="",e.href}function Me(e,t,r,n){if("src"===r||"href"===r&&n&&("use"!==t||"#"!==n[0]))return we(e,n);if("xlink:href"===r&&n&&"#"!==n[0]||"background"===r&&n&&("table"===t||"td"===t||"th"===t))return we(e,n);if("srcset"===r&&n){var o=e,a=n;if(""===a.trim())return a;var s=0;function i(e){var e=e.exec(a.substring(s));return e?(e=e[0],s+=e.length,e):""}for(var c=[];i(Ae),!(s>=a.length);)if(","===(d=i(be)).slice(-1))d=we(o,d.substring(0,d.length-1)),c.push(d);else for(var l="",d=we(o,d),u=!1;;){var h=a.charAt(s);if(""===h){c.push((d+l).trim());break}if(u)")"===h&&(u=!1);else{if(","===h){s+=1,c.push((d+l).trim());break}"("===h&&(u=!0)}l+=h,s+=1}return c.join(", ")}return"style"===r&&n?ve(n,ke()):"object"===t&&"data"===r&&n?we(e,n):n}function Te(e,t,r){if(!e)return!1;if(e.nodeType!==e.ELEMENT_NODE)return!!r&&Te(e.parentNode,t,r);for(var n=e.classList.length;n--;){var o=e.classList[n];if(t.test(o))return!0}return!!r&&Te(e.parentNode,t,r)}function Ne(e,t,r){e=e.nodeType===e.ELEMENT_NODE?e:e.parentElement;if(null!==e){if("string"==typeof t){if(e.classList.contains(t))return 1;if(e.closest(".".concat(t)))return 1}else if(Te(e,t,!0))return 1;if(r){if(e.matches(r))return 1;if(e.closest(r))return 1}}}function Re(e,t){var r=t.doc,n=t.mirror,o=t.blockClass,a=t.blockSelector,s=t.maskTextClass,i=t.maskTextSelector,c=t.inlineStylesheet,l=t.maskInputOptions,d=void 0===l?{}:l,u=t.maskTextFn,h=t.maskInputFn,l=t.dataURLOptions,p=void 0===l?{}:l,g=t.inlineImages,W=t.recordCanvas,V=t.keepIframeSrcFn,l=t.newlyAddedElement,Z=void 0!==l&&l,m=(t=r,!(l=n).hasNode(t)||1===(l=l.getId(t))?void 0:l);switch(e.nodeType){case e.DOCUMENT_NODE:return"CSS1Compat"!==e.compatMode?{type:U.Document,childNodes:[],compatMode:e.compatMode}:{type:U.Document,childNodes:[]};case e.DOCUMENT_TYPE_NODE:return{type:U.DocumentType,name:e.name,publicId:e.publicId,systemId:e.systemId,rootId:m};case e.ELEMENT_NODE:for(var I,f,C=e,y=(R={doc:r,blockClass:o,blockSelector:a,inlineStylesheet:c,maskInputOptions:d,maskInputFn:h,dataURLOptions:p,inlineImages:g,recordCanvas:W,keepIframeSrcFn:V,newlyAddedElement:Z,rootId:m}).doc,S=R.blockClass,v=R.blockSelector,b=R.inlineStylesheet,A=void 0===(A=R.maskInputOptions)?{}:A,w=R.maskInputFn,k=void 0===(M=R.dataURLOptions)?{}:M,M=R.inlineImages,T=R.recordCanvas,B=R.keepIframeSrcFn,N=void 0!==(N=R.newlyAddedElement)&&N,R=R.rootId,S=function(e,t,r){if("string"==typeof t){if(e.classList.contains(t))return!0}else for(var n=e.classList.length;n--;){var o=e.classList[n];if(t.test(o))return!0}return!!r&&e.matches(r)}(C,S,v),O=function(e){return e instanceof HTMLFormElement?"form":(e=e.tagName.toLowerCase().trim(),me.test(e)?"div":e)}(C),E={},G=C.attributes.length,D=0;D<G;D++){var x=C.attributes[D];E[x.name]=Me(y,O,x.name,x.value)}return"link"===O&&b&&(v=Array.from(y.styleSheets).find(function(e){return e.href===C.href}),L=null,L=v?ce(v):L)&&(delete E.rel,delete E.href,E._cssText=ve(L,v.href)),"style"===O&&C.sheet&&!(C.innerText||C.textContent||"").trim().length&&(L=ce(C.sheet))&&(E._cssText=ve(L,ke())),"input"!==O&&"textarea"!==O&&"select"!==O||(b=C.value,v=C.checked,"radio"!==E.type&&"checkbox"!==E.type&&"submit"!==E.type&&"button"!==E.type&&b?E.value=ue({type:E.type,tagName:O,value:b,maskInputOptions:A,maskInputFn:w}):v&&(E.checked=v)),"option"===O&&(C.selected&&!A.select?E.selected=!0:delete E.selected),"canvas"===O&&T&&("2d"===C.__context?function(e){var t=e.getContext("2d");if(t)for(var r=0;r<e.width;r+=50)for(var n=0;n<e.height;n+=50){var o=t.getImageData,o=he in o?o[he]:o;if(new Uint32Array(o.call(t,r,n,Math.min(50,e.width-r),Math.min(50,e.height-n)).data.buffer).some(function(e){return 0!==e}))return}return 1}(C)||(E.rr_dataURL=C.toDataURL(k.type,k.quality)):"__context"in C||(L=C.toDataURL(k.type,k.quality),(b=document.createElement("canvas")).width=C.width,b.height=C.height,w=b.toDataURL(k.type,k.quality),L!==w&&(E.rr_dataURL=L))),"img"===O&&M&&(K||(K=y.createElement("canvas"),pe=K.getContext("2d")),f=(I=C).crossOrigin,I.crossOrigin="anonymous",v=function(){try{K.width=I.naturalWidth,K.height=I.naturalHeight,pe.drawImage(I,0,0),E.rr_dataURL=K.toDataURL(k.type,k.quality)}catch(e){console.warn("Cannot inline img src=".concat(I.currentSrc,"! Error: ").concat(e))}f?E.crossOrigin=f:I.removeAttribute("crossorigin")},I.complete&&0!==I.naturalWidth?v():I.onload=v),"audio"!==O&&"video"!==O||(E.rr_mediaState=C.paused?"paused":"played",E.rr_mediaCurrentTime=C.currentTime),N||(C.scrollLeft&&(E.rr_scrollLeft=C.scrollLeft),C.scrollTop&&(E.rr_scrollTop=C.scrollTop)),S&&(A=C.getBoundingClientRect(),T=A.width,b=A.height,E={class:E.class,rr_width:"".concat(T,"px"),rr_height:"".concat(b,"px")}),"iframe"!==O||B(E.src)||(C.contentDocument||(E.rr_src=E.src),delete E.src),{type:U.Element,tagName:O,attributes:E,childNodes:[],isSVG:function(e){return Boolean("svg"===e.tagName||e.ownerSVGElement)}(C)||void 0,needBlock:S,rootId:R};case e.TEXT_NODE:var F,w=e,M=(L={maskTextClass:s,maskTextSelector:i,maskTextFn:u,rootId:m}).maskTextClass,v=L.maskTextSelector,N=L.maskTextFn,L=L.rootId,A=w.parentNode&&w.parentNode.tagName,T=w.textContent,b="STYLE"===A||void 0,A="SCRIPT"===A||void 0;if(b&&T){try{w.nextSibling||w.previousSibling||null!=(F=w.parentNode.sheet)&&F.cssRules&&(T=function(e){return e.cssRules?Array.from(e.cssRules).map(function(e){return e.cssText||""}).join(""):""}(w.parentNode.sheet))}catch(e){console.warn("Cannot get CSS styles from text's parentNode. Error: ".concat(e),w)}T=ve(T,ke())}return A&&(T="SCRIPT_PLACEHOLDER"),!b&&!A&&T&&Ne(w,M,v)&&(T=N?N(T):T.replace(/[\S]/g,"*")),{type:U.Text,textContent:T||"",isStyle:b,rootId:L};case e.CDATA_SECTION_NODE:return{type:U.CDATA,textContent:"",rootId:m};case e.COMMENT_NODE:return{type:U.Comment,textContent:e.textContent||"",rootId:m};default:return!1}}function D(e){return void 0===e?"":e.toLowerCase()}function J(t,e){var r=e.doc,n=e.mirror,o=e.blockClass,a=e.blockSelector,s=e.maskTextClass,i=e.maskTextSelector,c=e.skipChild,c=void 0!==c&&c,l=e.inlineStylesheet,d=void 0===l||l,l=e.maskInputOptions,u=void 0===l?{}:l,h=e.maskTextFn,p=e.maskInputFn,g=e.slimDOMOptions,l=e.dataURLOptions,m=void 0===l?{}:l,l=e.inlineImages,I=void 0!==l&&l,l=e.recordCanvas,f=void 0!==l&&l,C=e.onSerialize,y=e.onIframeLoad,l=e.iframeLoadTimeout,S=void 0===l?5e3:l,v=e.onStylesheetLoad,l=e.stylesheetLoadTimeout,b=void 0===l?5e3:l,l=e.keepIframeSrcFn,A=void 0===l?function(){return!1}:l,l=e.newlyAddedElement,e=e.preserveWhiteSpace,w=void 0===e||e,e=Re(t,{doc:r,mirror:n,blockClass:o,blockSelector:a,maskTextClass:s,maskTextSelector:i,inlineStylesheet:d,maskInputOptions:u,maskTextFn:h,maskInputFn:p,dataURLOptions:m,inlineImages:I,recordCanvas:f,keepIframeSrcFn:A,newlyAddedElement:void 0!==l&&l});if(!e)return console.warn(t,"not serialized"),null;var l=n.hasNode(t)?n.getId(t):!function(e,t){if(t.comment&&e.type===U.Comment)return 1;if(e.type===U.Element){if(t.script&&("script"===e.tagName||"link"===e.tagName&&"preload"===e.attributes.rel&&"script"===e.attributes.as||"link"===e.tagName&&"prefetch"===e.attributes.rel&&"string"==typeof e.attributes.href&&e.attributes.href.endsWith(".js")))return 1;if(t.headFavicon&&("link"===e.tagName&&"shortcut icon"===e.attributes.rel||"meta"===e.tagName&&(D(e.attributes.name).match(/^msapplication-tile(image|color)$/)||"application-name"===D(e.attributes.name)||"icon"===D(e.attributes.rel)||"apple-touch-icon"===D(e.attributes.rel)||"shortcut icon"===D(e.attributes.rel))))return 1;if("meta"===e.tagName){if(t.headMetaDescKeywords&&D(e.attributes.name).match(/^description|keywords$/))return 1;if(t.headMetaSocial&&(D(e.attributes.property).match(/^(og|twitter|fb):/)||D(e.attributes.name).match(/^(og|twitter):/)||"pinterest"===D(e.attributes.name)))return 1;if(t.headMetaRobots&&("robots"===D(e.attributes.name)||"googlebot"===D(e.attributes.name)||"bingbot"===D(e.attributes.name)))return 1;if(t.headMetaHttpEquiv&&void 0!==e.attributes["http-equiv"])return 1;if(t.headMetaAuthorship&&("author"===D(e.attributes.name)||"generator"===D(e.attributes.name)||"framework"===D(e.attributes.name)||"publisher"===D(e.attributes.name)||"progid"===D(e.attributes.name)||D(e.attributes.property).match(/^article:/)||D(e.attributes.property).match(/^product:/)))return 1;if(t.headMetaVerification&&("google-site-verification"===D(e.attributes.name)||"yandex-verification"===D(e.attributes.name)||"csrf-token"===D(e.attributes.name)||"p:domain_verify"===D(e.attributes.name)||"verify-v1"===D(e.attributes.name)||"verification"===D(e.attributes.name)||"shopify-checkout-api-token"===D(e.attributes.name)))return 1}}}(e,g)&&(w||e.type!==U.Text||e.isStyle||e.textContent.replace(/^\s+|\s+$/gm,"").length)?ge++:Ie,k=Object.assign(e,{id:l});if(n.add(t,k),l===Ie)return null;C&&C(t);e=!c;if(k.type===U.Element&&(e=e&&!k.needBlock,delete k.needBlock,l=t.shadowRoot)&&ie(l)&&(k.isShadowHost=!0),(k.type===U.Document||k.type===U.Element)&&e){g.headWhitespace&&k.type===U.Element&&"head"===k.tagName&&(w=!1);for(var M={doc:r,mirror:n,blockClass:o,blockSelector:a,maskTextClass:s,maskTextSelector:i,skipChild:c,inlineStylesheet:d,maskInputOptions:u,maskTextFn:h,maskInputFn:p,slimDOMOptions:g,dataURLOptions:m,inlineImages:I,recordCanvas:f,preserveWhiteSpace:w,onSerialize:C,onIframeLoad:y,iframeLoadTimeout:S,onStylesheetLoad:v,stylesheetLoadTimeout:b,keepIframeSrcFn:A},T=0,N=Array.from(t.childNodes);T<N.length;T++)(R=J(N[T],M))&&k.childNodes.push(R);if(t.nodeType===t.ELEMENT_NODE&&t.shadowRoot)for(var R,O=0,E=Array.from(t.shadowRoot.childNodes);O<E.length;O++)(R=J(E[O],M))&&(ie(t.shadowRoot)&&(R.isShadow=!0),k.childNodes.push(R))}return t.parentNode&&se(t.parentNode)&&ie(t.parentNode)&&(k.isShadow=!0),k.type===U.Element&&"iframe"===k.tagName&&function(e,t,r){var n=e.contentWindow;if(n){var o,a,s=!1;try{a=n.document.readyState}catch(e){return}if("complete"===a)return n.location.href!==(a="about:blank")||e.src===a||""===e.src?(setTimeout(t,0),e.addEventListener("load",t)):e.addEventListener("load",t);o=setTimeout(function(){s||(t(),s=!0)},r),e.addEventListener("load",function(){clearTimeout(o),s=!0,t()})}}(t,function(){var e=t.contentDocument;e&&y&&(e=J(e,{doc:e,mirror:n,blockClass:o,blockSelector:a,maskTextClass:s,maskTextSelector:i,skipChild:!1,inlineStylesheet:d,maskInputOptions:u,maskTextFn:h,maskInputFn:p,slimDOMOptions:g,dataURLOptions:m,inlineImages:I,recordCanvas:f,preserveWhiteSpace:w,onSerialize:C,onIframeLoad:y,iframeLoadTimeout:S,onStylesheetLoad:v,stylesheetLoadTimeout:b,keepIframeSrcFn:A}))&&y(t,e)},S),k.type===U.Element&&"link"===k.tagName&&"stylesheet"===k.attributes.rel&&function(e,t,r){var n,o,a=!1;try{n=e.sheet}catch(e){return}n||(o=setTimeout(function(){a||(t(),a=!0)},r),e.addEventListener("load",function(){clearTimeout(o),a=!0,t()}))}(t,function(){var e;v&&(e=J(t,{doc:r,mirror:n,blockClass:o,blockSelector:a,maskTextClass:s,maskTextSelector:i,skipChild:!1,inlineStylesheet:d,maskInputOptions:u,maskTextFn:h,maskInputFn:p,slimDOMOptions:g,dataURLOptions:m,inlineImages:I,recordCanvas:f,preserveWhiteSpace:w,onSerialize:C,onIframeLoad:y,iframeLoadTimeout:S,onStylesheetLoad:v,stylesheetLoadTimeout:b,keepIframeSrcFn:A}))&&v(t,e)},b),k}function H(e,t,r=document){const n={capture:!0,passive:!0};return r.addEventListener(e,t,n),()=>r.removeEventListener(e,t,n)}const n="Please stop import mirror directly. Instead of that,\r\nnow you can use replayer.getMirror() to access the mirror instance of a replayer,\r\nor you can use record.mirror to access the mirror instance during recording.";var o={map:{},getId(){return console.error(n),-1},getNode(){return console.error(n),null},removeNodeFromMap(){console.error(n)},has(){return console.error(n),!1},reset(){console.error(n)}};function Oe(o,a,s={}){let i=null,c=0;return function(...e){var t=Date.now(),r=(c||!1!==s.leading||(c=t),a-(t-c));const n=this;r<=0||a<r?(i&&(clearTimeout(i),i=null),c=t,o.apply(n,e)):i||!1===s.trailing||(i=setTimeout(()=>{c=!1===s.leading?0:Date.now(),i=null,o.apply(n,e)},r))}}function Ee(e,t,r,n,o=window){const a=o.Object.getOwnPropertyDescriptor(e,t);return o.Object.defineProperty(e,t,n?r:{set(e){setTimeout(()=>{r.set.call(this,e)},0),a&&a.set&&a.set.call(this,e)}}),()=>Ee(e,t,a||{},!0)}function E(e,t,r){try{if(!(t in e))return()=>{};const o=e[t];var n=r(o);return"function"==typeof n&&(n.prototype=n.prototype||{},Object.defineProperties(n,{__rrweb_original__:{enumerable:!1,value:o}})),e[t]=n,()=>{e[t]=o}}catch(e){return()=>{}}}function De(){return window.innerHeight||document.documentElement&&document.documentElement.clientHeight||document.body&&document.body.clientHeight}function xe(){return window.innerWidth||document.documentElement&&document.documentElement.clientWidth||document.body&&document.body.clientWidth}function x(e,t,r,n){if(e){var o=e.nodeType===e.ELEMENT_NODE?e:e.parentElement;if(o){if("string"==typeof t){if(o.classList.contains(t))return!0;if(n&&null!==o.closest("."+t))return!0}else if(Te(o,t,n))return!0;if(r){if(e.matches(r))return!0;if(n&&null!==o.closest(r))return!0}}}return!1}function Fe(e,t){return t.getId(e)===Ie}function Le(e){return Boolean(e.changedTouches)}function We(e,t){return Boolean("IFRAME"===e.nodeName&&t.getMeta(e))}function Ve(e,t){return Boolean("LINK"===e.nodeName&&e.nodeType===e.ELEMENT_NODE&&e.getAttribute&&"stylesheet"===e.getAttribute("rel")&&t.getMeta(e))}function Ze(e){return Boolean(null==e?void 0:e.shadowRoot)}"undefined"!=typeof window&&window.Proxy&&window.Reflect&&new Proxy(o,{get(e,t,r){return"map"===t&&console.error(n),Reflect.get(e,t,r)}});class Be{constructor(){this.id=1,this.styleIDMap=new WeakMap,this.idStyleMap=new Map}getId(e){return null!=(e=this.styleIDMap.get(e))?e:-1}has(e){return this.styleIDMap.has(e)}add(e,t){if(this.has(e))return this.getId(e);let r;return r=void 0===t?this.id++:t,this.styleIDMap.set(e,r),this.idStyleMap.set(r,e),r}getStyle(e){return this.idStyleMap.get(e)||null}reset(){this.styleIDMap=new WeakMap,this.idStyleMap=new Map,this.id=1}generateId(){return this.id++}}var z=(e=>(e[e.DomContentLoaded=0]="DomContentLoaded",e[e.Load=1]="Load",e[e.FullSnapshot=2]="FullSnapshot",e[e.IncrementalSnapshot=3]="IncrementalSnapshot",e[e.Meta=4]="Meta",e[e.Custom=5]="Custom",e[e.Plugin=6]="Plugin",e))({}),j=(e=>(e[e.Mutation=0]="Mutation",e[e.MouseMove=1]="MouseMove",e[e.MouseInteraction=2]="MouseInteraction",e[e.Scroll=3]="Scroll",e[e.ViewportResize=4]="ViewportResize",e[e.Input=5]="Input",e[e.TouchMove=6]="TouchMove",e[e.MediaInteraction=7]="MediaInteraction",e[e.StyleSheetRule=8]="StyleSheetRule",e[e.CanvasMutation=9]="CanvasMutation",e[e.Font=10]="Font",e[e.Log=11]="Log",e[e.Drag=12]="Drag",e[e.StyleDeclaration=13]="StyleDeclaration",e[e.Selection=14]="Selection",e[e.AdoptedStyleSheet=15]="AdoptedStyleSheet",e))(j||{}),Ge=(e=>(e[e.MouseUp=0]="MouseUp",e[e.MouseDown=1]="MouseDown",e[e.Click=2]="Click",e[e.ContextMenu=3]="ContextMenu",e[e.DblClick=4]="DblClick",e[e.Focus=5]="Focus",e[e.Blur=6]="Blur",e[e.TouchStart=7]="TouchStart",e[e.TouchMove_Departed=8]="TouchMove_Departed",e[e.TouchEnd=9]="TouchEnd",e[e.TouchCancel=10]="TouchCancel",e))(Ge||{}),Ue=(e=>(e[e["2D"]=0]="2D",e[e.WebGL=1]="WebGL",e[e.WebGL2=2]="WebGL2",e))({});function Ke(e){return"__ln"in e}class Ye{constructor(){this.length=0,this.head=null}get(t){if(t>=this.length)throw new Error("Position outside of list range");let r=this.head;for(let e=0;e<t;e++)r=(null===r||void 0===r?void 0:r.next)||null;return r}addNode(e){var t,r={value:e,previous:null,next:null};e.__ln=r,e.previousSibling&&Ke(e.previousSibling)?(t=e.previousSibling.__ln.next,r.next=t,r.previous=e.previousSibling.__ln,e.previousSibling.__ln.next=r,t&&(t.previous=r)):e.nextSibling&&Ke(e.nextSibling)&&e.nextSibling.__ln.previous?(t=e.nextSibling.__ln.previous,r.previous=t,r.next=e.nextSibling.__ln,e.nextSibling.__ln.previous=r,t&&(t.next=r)):(this.head&&(this.head.previous=r),r.next=this.head,this.head=r),this.length++}removeNode(e){var t=e.__ln;this.head&&(t.previous?(t.previous.next=t.next,t.next&&(t.next.previous=t.previous)):(this.head=t.next,this.head&&(this.head.previous=null)),e.__ln&&delete e.__ln,this.length--)}}class _e{constructor(){this.frozen=!1,this.locked=!1,this.texts=[],this.attributes=[],this.removes=[],this.mapRemoves=[],this.movedMap={},this.addedSet=new Set,this.movedSet=new Set,this.droppedSet=new Set,this.processMutations=e=>{e.forEach(this.processMutation),this.emit()},this.emit=()=>{if(!this.frozen&&!this.locked){const c=[],l=new Ye,d=e=>{let t=e,r=Ie;for(;r===Ie;)t=t&&t.nextSibling,r=t&&this.mirror.getId(t);return r};for(var r,n,o=t=>{var e;let r=null,n=r=(null==(s=null==(s=t.getRootNode)?void 0:s.call(t))?void 0:s.nodeType)===Node.DOCUMENT_FRAGMENT_NODE&&t.getRootNode().host?t.getRootNode().host:r;for(;(null==(e=null==(e=null===n||void 0===n?void 0:n.getRootNode)?void 0:e.call(n))?void 0:e.nodeType)===Node.DOCUMENT_FRAGMENT_NODE&&n.getRootNode().host;)n=n.getRootNode().host;var o,a,s=!(this.doc.contains(t)||n&&this.doc.contains(n));if(t.parentNode&&!s)return s=se(t.parentNode)?this.mirror.getId(r):this.mirror.getId(t.parentNode),o=d(t),-1===s||-1===o?l.addNode(t):void((a=J(t,{doc:this.doc,mirror:this.mirror,blockClass:this.blockClass,blockSelector:this.blockSelector,maskTextClass:this.maskTextClass,maskTextSelector:this.maskTextSelector,skipChild:!0,newlyAddedElement:!0,inlineStylesheet:this.inlineStylesheet,maskInputOptions:this.maskInputOptions,maskTextFn:this.maskTextFn,maskInputFn:this.maskInputFn,slimDOMOptions:this.slimDOMOptions,dataURLOptions:this.dataURLOptions,recordCanvas:this.recordCanvas,inlineImages:this.inlineImages,onSerialize:e=>{We(e,this.mirror)&&this.iframeManager.addIframe(e),Ve(e,this.mirror)&&this.stylesheetManager.trackLinkElement(e),Ze(t)&&this.shadowDomManager.addShadowRoot(t.shadowRoot,this.doc)},onIframeLoad:(e,t)=>{this.iframeManager.attachIframe(e,t),this.shadowDomManager.observeAttachShadow(e)},onStylesheetLoad:(e,t)=>{this.stylesheetManager.attachLinkElement(e,t)}}))&&c.push({parentId:s,nextId:o,node:a}))};this.mapRemoves.length;)this.mirror.removeNodeFromMap(this.mapRemoves.shift());for(const u of Array.from(this.movedSet.values()))He(this.removes,u,this.mirror)&&!this.movedSet.has(u.parentNode)||o(u);for(const h of Array.from(this.addedSet.values()))!ze(this.droppedSet,h)&&!He(this.removes,h,this.mirror)||ze(this.movedSet,h)?o(h):this.droppedSet.add(h);let e=null;for(;l.length;){let t=null;if(!(t=e&&(r=this.mirror.getId(e.value.parentNode),n=d(e.value),-1!==r)&&-1!==n?e:t))for(let e=l.length-1;0<=e;e--){var a=l.get(e);if(a){var s=this.mirror.getId(a.value.parentNode),i=d(a.value);if(-1!==i){if(-1!==s){t=a;break}i=a.value;if(i.parentNode&&i.parentNode.nodeType===Node.DOCUMENT_FRAGMENT_NODE){s=i.parentNode.host;if(-1!==this.mirror.getId(s)){t=a;break}}}}}if(!t){for(;l.head;)l.removeNode(l.head.value);break}e=t.previous,l.removeNode(t.value),o(t.value)}var t={texts:this.texts.map(e=>({id:this.mirror.getId(e.node),value:e.value})).filter(e=>this.mirror.has(e.id)),attributes:this.attributes.map(e=>({id:this.mirror.getId(e.node),attributes:e.attributes})).filter(e=>this.mirror.has(e.id)),removes:this.removes,adds:c};(t.texts.length||t.attributes.length||t.removes.length||t.adds.length)&&(this.texts=[],this.attributes=[],this.removes=[],this.addedSet=new Set,this.movedSet=new Set,this.droppedSet=new Set,this.movedMap={},this.mutationCb(t))}},this.processMutation=n=>{if(!Fe(n.target,this.mirror))switch(n.type){case"characterData":var e=n.target.textContent;x(n.target,this.blockClass,this.blockSelector,!1)||e===n.oldValue||this.texts.push({value:Ne(n.target,this.maskTextClass,this.maskTextSelector)&&e?this.maskTextFn?this.maskTextFn(e):e.replace(/[\S]/g,"*"):e,node:n.target});break;case"attributes":{var r=n.target;let e=n.target.getAttribute(n.attributeName);if("value"===n.attributeName&&(e=ue({maskInputOptions:this.maskInputOptions,tagName:n.target.tagName,type:n.target.getAttribute("type"),value:e,maskInputFn:this.maskInputFn})),x(n.target,this.blockClass,this.blockSelector,!1)||e===n.oldValue)return;let t=this.attributes.find(e=>e.node===n.target);if("IFRAME"===r.tagName&&"src"===n.attributeName&&!this.keepIframeSrcFn(e)){if(r.contentDocument)return;n.attributeName="rr_src"}if(t||(t={node:n.target,attributes:{}},this.attributes.push(t)),"style"===n.attributeName){var o=this.doc.createElement("span"),a=(n.oldValue&&o.setAttribute("style",n.oldValue),void 0!==t.attributes.style&&null!==t.attributes.style||(t.attributes.style={}),t.attributes.style);for(const c of Array.from(r.style)){var s=r.style.getPropertyValue(c),i=r.style.getPropertyPriority(c);s===o.style.getPropertyValue(c)&&i===o.style.getPropertyPriority(c)||(a[c]=""===i?s:[s,i])}for(const l of Array.from(o.style))""===r.style.getPropertyValue(l)&&(a[l]=!1)}else t.attributes[n.attributeName]=Me(this.doc,r.tagName,n.attributeName,e);break}case"childList":x(n.target,this.blockClass,this.blockSelector,!0)||(n.addedNodes.forEach(e=>this.genAdds(e,n.target)),n.removedNodes.forEach(e=>{var t=this.mirror.getId(e),r=se(n.target)?this.mirror.getId(n.target.host):this.mirror.getId(n.target);x(n.target,this.blockClass,this.blockSelector,!1)||Fe(e,this.mirror)||-1===this.mirror.getId(e)||(this.addedSet.has(e)?(Je(this.addedSet,e),this.droppedSet.add(e)):this.addedSet.has(n.target)&&-1===t||function e(t,r){var n;return!se(t)&&(n=r.getId(t),!r.has(n)||(!t.parentNode||t.parentNode.nodeType!==t.DOCUMENT_NODE)&&(!t.parentNode||e(t.parentNode,r)))}(n.target,this.mirror)||(this.movedSet.has(e)&&this.movedMap[t+"@"+r]?Je(this.movedSet,e):this.removes.push({parentId:r,id:t,isShadow:!(!se(n.target)||!ie(n.target))||void 0})),this.mapRemoves.push(e))}))}},this.genAdds=(t,r)=>{if(this.mirror.hasNode(t)){if(Fe(t,this.mirror))return;this.movedSet.add(t);let e=null;(e=r&&this.mirror.hasNode(r)?this.mirror.getId(r):e)&&-1!==e&&(this.movedMap[this.mirror.getId(t)+"@"+e]=!0)}else this.addedSet.add(t),this.droppedSet.delete(t);x(t,this.blockClass,this.blockSelector,!1)||t.childNodes.forEach(e=>this.genAdds(e))}}init(t){["mutationCb","blockClass","blockSelector","maskTextClass","maskTextSelector","inlineStylesheet","maskInputOptions","maskTextFn","maskInputFn","keepIframeSrcFn","recordCanvas","inlineImages","slimDOMOptions","dataURLOptions","doc","mirror","iframeManager","stylesheetManager","shadowDomManager","canvasManager"].forEach(e=>{this[e]=t[e]})}freeze(){this.frozen=!0,this.canvasManager.freeze()}unfreeze(){this.frozen=!1,this.canvasManager.unfreeze(),this.emit()}isFrozen(){return this.frozen}lock(){this.locked=!0,this.canvasManager.lock()}unlock(){this.locked=!1,this.canvasManager.unlock(),this.emit()}reset(){this.shadowDomManager.reset(),this.canvasManager.reset()}}function Je(t,e){t.delete(e),e.childNodes.forEach(e=>Je(t,e))}function He(e,t,r){return 0!==e.length&&function e(t,r,n){const o=r["parentNode"];if(!o)return!1;const a=n.getId(o);if(t.some(e=>e.id===a))return!0;return e(t,o,n)}(e,t,r)}function ze(e,t){return 0!==e.size&&function e(t,r){const n=r["parentNode"];if(!n)return!1;if(t.has(n))return!0;return e(t,n)}(e,t)}const Q=[],je="undefined"!=typeof CSSGroupingRule,Qe="undefined"!=typeof CSSMediaRule,Xe="undefined"!=typeof CSSSupportsRule,Pe="undefined"!=typeof CSSConditionRule;function qe(t){try{if("composedPath"in t){var e=t.composedPath();if(e.length)return e[0]}else if("path"in t&&t.path.length)return t.path[0];return t.target}catch(e){return t.target}}function $e(e,t){var r=new _e;Q.push(r),r.init(e);let n=window.MutationObserver||window.__rrMutationObserver;var o=null==(o=null==(e=null===window||void 0===window?void 0:window.Zone)?void 0:e.__symbol__)?void 0:o.call(e,"MutationObserver"),e=new(n=o&&window[o]?window[o]:n)(r.processMutations.bind(r));return e.observe(t,{attributes:!0,attributeOldValue:!0,characterData:!0,characterDataOldValue:!0,childList:!0,subtree:!0}),e}function et({mouseInteractionCb:o,doc:r,mirror:a,blockClass:s,blockSelector:i,sampling:e}){if(!1===e.mouseInteraction)return()=>{};const t=!0===e.mouseInteraction||void 0===e.mouseInteraction?{}:e.mouseInteraction,c=[];return Object.keys(Ge).filter(e=>Number.isNaN(Number(e))&&!e.endsWith("_Departed")&&!1!==t[e]).forEach(e=>{var n,t=e.toLowerCase(),e=(n=e,e=>{var t,r=qe(e);x(r,s,i,!0)||(e=Le(e)?e.changedTouches[0]:e)&&(r=a.getId(r),{clientX:e,clientY:t}=e,o({type:Ge[n],id:r,x:e,y:t}))});c.push(H(t,e,r))}),()=>{c.forEach(e=>e())}}function tt({scrollCb:n,doc:o,mirror:a,blockClass:s,blockSelector:i,sampling:e}){return H("scroll",Oe(e=>{var t,r,e=qe(e);e&&!x(e,s,i,!0)&&(t=a.getId(e),e===o?(r=o.scrollingElement||o.documentElement,n({id:t,x:r.scrollLeft,y:r.scrollTop})):n({id:t,x:e.scrollLeft,y:e.scrollTop}))},e.scroll||100),o)}function rt(e,t){e=Object.assign({},e);return t||delete e.userTriggered,e}const nt=["INPUT","TEXTAREA","SELECT"],ot=new WeakMap;function at(e){var t,r;return e=e,t=[],je&&e.parentRule instanceof CSSGroupingRule||Qe&&e.parentRule instanceof CSSMediaRule||Xe&&e.parentRule instanceof CSSSupportsRule||Pe&&e.parentRule instanceof CSSConditionRule?(r=Array.from(e.parentRule.cssRules).indexOf(e),t.unshift(r)):e.parentStyleSheet&&(r=Array.from(e.parentStyleSheet.cssRules).indexOf(e),t.unshift(r)),t}function F(e,t,r){let n,o;return e?(e.ownerNode?n=t.getId(e.ownerNode):o=r.getId(e),{styleId:o,id:n}):{}}function st({mirror:e,stylesheetManager:r},t){let n=null;n="#document"===t.nodeName?e.getId(t):e.getId(t.host);e="#document"===t.nodeName?null==(e=t.defaultView)?void 0:e.Document:null==(e=null==(e=t.ownerDocument)?void 0:e.defaultView)?void 0:e.ShadowRoot;const o=Object.getOwnPropertyDescriptor(null==e?void 0:e.prototype,"adoptedStyleSheets");return null!==n&&-1!==n&&e&&o?(Object.defineProperty(t,"adoptedStyleSheets",{configurable:o.configurable,enumerable:o.enumerable,get(){var e;return null==(e=o.get)?void 0:e.call(this)},set(e){var t=null==(t=o.set)?void 0:t.call(this,e);if(null!==n&&-1!==n)try{r.adoptStyleSheets(e,n)}catch(e){}return t}}),()=>{Object.defineProperty(t,"adoptedStyleSheets",{configurable:o.configurable,enumerable:o.enumerable,get:o.get,set:o.set})}):()=>{}}function it(e,t={}){var r=e.doc.defaultView;if(!r)return()=>{};{var n=e,o=t;const{mutationCb:C,mousemoveCb:y,mouseInteractionCb:S,scrollCb:v,viewportResizeCb:b,inputCb:A,mediaInteractionCb:w,styleSheetRuleCb:k,styleDeclarationCb:M,canvasMutationCb:T,fontCb:N,selectionCb:R}=n;n.mutationCb=(...e)=>{o.mutation&&o.mutation(...e),C(...e)},n.mousemoveCb=(...e)=>{o.mousemove&&o.mousemove(...e),y(...e)},n.mouseInteractionCb=(...e)=>{o.mouseInteraction&&o.mouseInteraction(...e),S(...e)},n.scrollCb=(...e)=>{o.scroll&&o.scroll(...e),v(...e)},n.viewportResizeCb=(...e)=>{o.viewportResize&&o.viewportResize(...e),b(...e)},n.inputCb=(...e)=>{o.input&&o.input(...e),A(...e)},n.mediaInteractionCb=(...e)=>{o.mediaInteaction&&o.mediaInteaction(...e),w(...e)},n.styleSheetRuleCb=(...e)=>{o.styleSheetRule&&o.styleSheetRule(...e),k(...e)},n.styleDeclarationCb=(...e)=>{o.styleDeclaration&&o.styleDeclaration(...e),M(...e)},n.canvasMutationCb=(...e)=>{o.canvasMutation&&o.canvasMutation(...e),T(...e)},n.fontCb=(...e)=>{o.font&&o.font(...e),N(...e)},n.selectionCb=(...e)=>{o.selection&&o.selection(...e),R(...e)}}const a=$e(e,e.doc),s=function({mousemoveCb:r,sampling:e,doc:t,mirror:o}){if(!1===e.mousemove)return()=>{};var n="number"==typeof e.mousemove?e.mousemove:50,e="number"==typeof e.mousemoveCallback?e.mousemoveCallback:500;let a=[],s;const i=Oe(e=>{const t=Date.now()-s;r(a.map(e=>(e.timeOffset-=t,e)),e),a=[],s=null},e),c=[H("mousemove",e=Oe(e=>{var t=qe(e),{clientX:r,clientY:n}=Le(e)?e.changedTouches[0]:e;s=s||Date.now(),a.push({x:r,y:n,id:o.getId(t),timeOffset:Date.now()-s}),i("undefined"!=typeof DragEvent&&e instanceof DragEvent?j.Drag:e instanceof MouseEvent?j.MouseMove:j.TouchMove)},n,{trailing:!1}),t),H("touchmove",e,t),H("drag",e,t)];return()=>{c.forEach(e=>e())}}(e),i=et(e),c=tt(e),l=function({viewportResizeCb:r}){let n=-1,o=-1;return H("resize",Oe(()=>{var e=De(),t=xe();n===e&&o===t||(r({width:Number(t),height:Number(e)}),n=e,o=t)},200),window)}(e),d=function({inputCb:n,doc:a,mirror:o,blockClass:e,blockSelector:t,ignoreClass:s,maskInputOptions:i,maskInputFn:c,sampling:r,userTriggeredOnInput:l}){function d(r){let n=qe(r);r=r.isTrusted;if((n=n&&"OPTION"===n.tagName?n.parentElement:n)&&n.tagName&&!(nt.indexOf(n.tagName)<0)&&!x(n,e,t,!0)){var o=n.type;if(!n.classList.contains(s)){let e=n.value,t=!1;"radio"===o||"checkbox"===o?t=n.checked:(i[n.tagName.toLowerCase()]||i[o])&&(e=ue({maskInputOptions:i,tagName:n.tagName,type:o,value:e,maskInputFn:c})),u(n,rt({text:e,isChecked:t,userTriggered:r},l));r=n.name;"radio"===o&&r&&t&&a.querySelectorAll(`input[type="radio"][name="${r}"]`).forEach(e=>{e!==n&&u(e,rt({text:e.value,isChecked:!t,userTriggered:!1},l))})}}}function u(e,t){var r=ot.get(e);r&&r.text===t.text&&r.isChecked===t.isChecked||(ot.set(e,t),r=o.getId(e),n(Object.assign(Object.assign({},t),{id:r})))}var h;const p=("last"===r.input?["change"]:["input","change"]).map(e=>H(e,d,a)),g=a.defaultView;return g?(r=g.Object.getOwnPropertyDescriptor(g.HTMLInputElement.prototype,"value"),h=[[g.HTMLInputElement.prototype,"value"],[g.HTMLInputElement.prototype,"checked"],[g.HTMLSelectElement.prototype,"value"],[g.HTMLTextAreaElement.prototype,"value"],[g.HTMLSelectElement.prototype,"selectedIndex"],[g.HTMLOptionElement.prototype,"selected"]],r&&r.set&&p.push(...h.map(e=>Ee(e[0],e[1],{set(){d({target:this})}},!1,g))),()=>{p.forEach(e=>e())}):()=>{p.forEach(e=>e())}}(e),u=function({mediaInteractionCb:s,blockClass:i,blockSelector:c,mirror:l,sampling:e}){var t=a=>Oe(e=>{var t,r,n,o,e=qe(e);e&&!x(e,i,c,!0)&&({currentTime:t,volume:r,muted:n,playbackRate:o}=e,s({type:a,id:l.getId(e),currentTime:t,volume:r,muted:n,playbackRate:o}))},e.media||500);const r=[H("play",t(0)),H("pause",t(1)),H("seeked",t(2)),H("volumechange",t(3)),H("ratechange",t(4))];return()=>{r.forEach(e=>e())}}(e),h=function({styleSheetRuleCb:a,mirror:s,stylesheetManager:i},{win:e}){const o=e.CSSStyleSheet.prototype.insertRule,n=(e.CSSStyleSheet.prototype.insertRule=function(e,t){var{id:r,styleId:n}=F(this,s,i.styleMirror);return(r&&-1!==r||n&&-1!==n)&&a({id:r,styleId:n,adds:[{rule:e,index:t}]}),o.apply(this,[e,t])},e.CSSStyleSheet.prototype.deleteRule);e.CSSStyleSheet.prototype.deleteRule=function(e){var{id:t,styleId:r}=F(this,s,i.styleMirror);return(t&&-1!==t||r&&-1!==r)&&a({id:t,styleId:r,removes:[{index:e}]}),n.apply(this,[e])};let c;e.CSSStyleSheet.prototype.replace&&(c=e.CSSStyleSheet.prototype.replace,e.CSSStyleSheet.prototype.replace=function(e){var{id:t,styleId:r}=F(this,s,i.styleMirror);return(t&&-1!==t||r&&-1!==r)&&a({id:t,styleId:r,replace:e}),c.apply(this,[e])});let l;e.CSSStyleSheet.prototype.replaceSync&&(l=e.CSSStyleSheet.prototype.replaceSync,e.CSSStyleSheet.prototype.replaceSync=function(e){var{id:t,styleId:r}=F(this,s,i.styleMirror);return(t&&-1!==t||r&&-1!==r)&&a({id:t,styleId:r,replaceSync:e}),l.apply(this,[e])});const t={},d=(je?t.CSSGroupingRule=e.CSSGroupingRule:(Qe&&(t.CSSMediaRule=e.CSSMediaRule),Pe&&(t.CSSConditionRule=e.CSSConditionRule),Xe&&(t.CSSSupportsRule=e.CSSSupportsRule)),{});return Object.entries(t).forEach(([o,e])=>{d[o]={insertRule:e.prototype.insertRule,deleteRule:e.prototype.deleteRule},e.prototype.insertRule=function(e,t){var{id:r,styleId:n}=F(this.parentStyleSheet,s,i.styleMirror);return(r&&-1!==r||n&&-1!==n)&&a({id:r,styleId:n,adds:[{rule:e,index:[...at(this),t||0]}]}),d[o].insertRule.apply(this,[e,t])},e.prototype.deleteRule=function(e){var{id:t,styleId:r}=F(this.parentStyleSheet,s,i.styleMirror);return(t&&-1!==t||r&&-1!==r)&&a({id:t,styleId:r,removes:[{index:[...at(this),e]}]}),d[o].deleteRule.apply(this,[e])}}),()=>{e.CSSStyleSheet.prototype.insertRule=o,e.CSSStyleSheet.prototype.deleteRule=n,c&&(e.CSSStyleSheet.prototype.replace=c),l&&(e.CSSStyleSheet.prototype.replaceSync=l),Object.entries(t).forEach(([e,t])=>{t.prototype.insertRule=d[e].insertRule,t.prototype.deleteRule=d[e].deleteRule})}}(e,{win:r}),p=st(e,e.doc),g=function({styleDeclarationCb:a,mirror:s,ignoreCSSAttributes:i,stylesheetManager:c},{win:e}){const l=e.CSSStyleDeclaration.prototype.setProperty,n=(e.CSSStyleDeclaration.prototype.setProperty=function(e,t,r){var n,o;return!i.has(e)&&({id:n,styleId:o}=F(null==(n=this.parentRule)?void 0:n.parentStyleSheet,s,c.styleMirror),n&&-1!==n||o&&-1!==o)&&a({id:n,styleId:o,set:{property:e,value:t,priority:r},index:at(this.parentRule)}),l.apply(this,[e,t,r])},e.CSSStyleDeclaration.prototype.removeProperty);return e.CSSStyleDeclaration.prototype.removeProperty=function(e){var t,r;return!i.has(e)&&({id:t,styleId:r}=F(null==(t=this.parentRule)?void 0:t.parentStyleSheet,s,c.styleMirror),t&&-1!==t||r&&-1!==r)&&a({id:t,styleId:r,remove:{property:e},index:at(this.parentRule)}),n.apply(this,[e])},()=>{e.CSSStyleDeclaration.prototype.setProperty=l,e.CSSStyleDeclaration.prototype.removeProperty=n}}(e,{win:r}),m=e.collectFonts?function({fontCb:r,doc:e}){const t=e.defaultView;if(!t)return()=>{};const n=[],o=new WeakMap,a=t.FontFace;return t.FontFace=function(e,t,r){var n=new a(e,t,r);return o.set(n,{family:e,buffer:"string"!=typeof t,descriptors:r,fontSource:"string"==typeof t?t:JSON.stringify(Array.from(new Uint8Array(t)))}),n},e=E(e.fonts,"add",function(e){return function(t){return setTimeout(()=>{var e=o.get(t);e&&(r(e),o.delete(t))},0),e.apply(this,[t])}}),n.push(()=>{t.FontFace=a}),n.push(e),()=>{n.forEach(e=>e())}}(e):()=>{},I=function(e){const{doc:c,mirror:l,blockClass:d,blockSelector:u,selectionCb:h}=e;let p=!0;return(e=()=>{var t=c.getSelection();if(!(!t||p&&null!=t&&t.isCollapsed)){p=t.isCollapsed||!1;var r=[],n=t.rangeCount||0;for(let e=0;e<n;e++){var{startContainer:o,startOffset:a,endContainer:s,endOffset:i}=t.getRangeAt(e);x(o,d,u,!0)||x(s,d,u,!0)||r.push({start:l.getId(o),startOffset:a,end:l.getId(s),endOffset:i})}h({ranges:r})}})(),H("selectionchange",e)}(e),f=[];for(const O of e.plugins)f.push(O.observer(O.callback,r,O.options));return()=>{Q.forEach(e=>e.reset()),a.disconnect(),s(),i(),c(),l(),d(),u(),h(),p(),g(),m(),I(),f.forEach(e=>e())}}class ct{constructor(e){this.generateIdFn=e,this.iframeIdToRemoteIdMap=new WeakMap,this.iframeRemoteIdToIdMap=new WeakMap}getId(e,t,r,n){r=r||this.getIdToRemoteIdMap(e),n=n||this.getRemoteIdToIdMap(e);let o=r.get(t);return o||(o=this.generateIdFn(),r.set(t,o),n.set(o,t)),o}getIds(t,e){const r=this.getIdToRemoteIdMap(t),n=this.getRemoteIdToIdMap(t);return e.map(e=>this.getId(t,e,r,n))}getRemoteId(e,t,r){r=r||this.getRemoteIdToIdMap(e);return"number"!=typeof t?t:r.get(t)||-1}getRemoteIds(t,e){const r=this.getRemoteIdToIdMap(t);return e.map(e=>this.getRemoteId(t,e,r))}reset(e){e?(this.iframeIdToRemoteIdMap.delete(e),this.iframeRemoteIdToIdMap.delete(e)):(this.iframeIdToRemoteIdMap=new WeakMap,this.iframeRemoteIdToIdMap=new WeakMap)}getIdToRemoteIdMap(e){let t=this.iframeIdToRemoteIdMap.get(e);return t||(t=new Map,this.iframeIdToRemoteIdMap.set(e,t)),t}getRemoteIdToIdMap(e){let t=this.iframeRemoteIdToIdMap.get(e);return t||(t=new Map,this.iframeRemoteIdToIdMap.set(e,t)),t}}class lt{constructor(e){this.iframes=new WeakMap,this.crossOriginIframeMap=new WeakMap,this.crossOriginIframeMirror=new ct(fe),this.mutationCb=e.mutationCb,this.wrappedEmit=e.wrappedEmit,this.stylesheetManager=e.stylesheetManager,this.recordCrossOriginIframes=e.recordCrossOriginIframes,this.crossOriginIframeStyleMirror=new ct(this.stylesheetManager.styleMirror.generateId.bind(this.stylesheetManager.styleMirror)),this.mirror=e.mirror,this.recordCrossOriginIframes&&window.addEventListener("message",this.handleMessage.bind(this))}addIframe(e){this.iframes.set(e,!0),e.contentWindow&&this.crossOriginIframeMap.set(e.contentWindow,e)}addLoadListener(e){this.loadListener=e}attachIframe(e,t){this.mutationCb({adds:[{parentId:this.mirror.getId(e),nextId:null,node:t}],removes:[],texts:[],attributes:[],isAttachIframe:!0}),null!=(t=this.loadListener)&&t.call(this,e),e.contentDocument&&e.contentDocument.adoptedStyleSheets&&0<e.contentDocument.adoptedStyleSheets.length&&this.stylesheetManager.adoptStyleSheets(e.contentDocument.adoptedStyleSheets,this.mirror.getId(e.contentDocument))}handleMessage(e){var t;"rrweb"===e.data.type&&e.source&&(t=this.crossOriginIframeMap.get(e.source))&&(t=this.transformCrossOriginEvent(t,e.data.event))&&this.wrappedEmit(t,e.data.isCheckout)}transformCrossOriginEvent(t,e){var r;switch(e.type){case z.FullSnapshot:return this.crossOriginIframeMirror.reset(t),this.crossOriginIframeStyleMirror.reset(t),this.replaceIdOnNode(e.data.node,t),{timestamp:e.timestamp,type:z.IncrementalSnapshot,data:{source:j.Mutation,adds:[{parentId:this.mirror.getId(t),nextId:null,node:e.data.node}],removes:[],texts:[],attributes:[],isAttachIframe:!0}};case z.Meta:case z.Load:case z.DomContentLoaded:return!1;case z.Plugin:return e;case z.Custom:return this.replaceIds(e.data.payload,t,["id","parentId","previousId","nextId"]),e;case z.IncrementalSnapshot:switch(e.data.source){case j.Mutation:return e.data.adds.forEach(e=>{this.replaceIds(e,t,["parentId","nextId","previousId"]),this.replaceIdOnNode(e.node,t)}),e.data.removes.forEach(e=>{this.replaceIds(e,t,["parentId","id"])}),e.data.attributes.forEach(e=>{this.replaceIds(e,t,["id"])}),e.data.texts.forEach(e=>{this.replaceIds(e,t,["id"])}),e;case j.Drag:case j.TouchMove:case j.MouseMove:return e.data.positions.forEach(e=>{this.replaceIds(e,t,["id"])}),e;case j.ViewportResize:return!1;case j.MediaInteraction:case j.MouseInteraction:case j.Scroll:case j.CanvasMutation:case j.Input:return this.replaceIds(e.data,t,["id"]),e;case j.StyleSheetRule:case j.StyleDeclaration:return this.replaceIds(e.data,t,["id"]),this.replaceStyleIds(e.data,t,["styleId"]),e;case j.Font:return e;case j.Selection:return e.data.ranges.forEach(e=>{this.replaceIds(e,t,["start","end"])}),e;case j.AdoptedStyleSheet:return this.replaceIds(e.data,t,["id"]),this.replaceStyleIds(e.data,t,["styleIds"]),null!=(r=e.data.styles)&&r.forEach(e=>{this.replaceStyleIds(e,t,["styleId"])}),e}}}replace(e,t,r,n){for(const o of n)!Array.isArray(t[o])&&"number"!=typeof t[o]||(Array.isArray(t[o])?t[o]=e.getIds(r,t[o]):t[o]=e.getId(r,t[o]));return t}replaceIds(e,t,r){return this.replace(this.crossOriginIframeMirror,e,t,r)}replaceStyleIds(e,t,r){return this.replace(this.crossOriginIframeStyleMirror,e,t,r)}replaceIdOnNode(e,t){this.replaceIds(e,t,["id"]),"childNodes"in e&&e.childNodes.forEach(e=>{this.replaceIdOnNode(e,t)})}}class dt{constructor(e){this.shadowDoms=new WeakSet,this.restorePatches=[],this.mutationCb=e.mutationCb,this.scrollCb=e.scrollCb,this.bypassOptions=e.bypassOptions,this.mirror=e.mirror;const r=this;this.restorePatches.push(E(Element.prototype,"attachShadow",function(t){return function(e){e=t.call(this,e);return this.shadowRoot&&r.addShadowRoot(this.shadowRoot,this.ownerDocument),e}}))}addShadowRoot(e,t){!ie(e)||this.shadowDoms.has(e)||(this.shadowDoms.add(e),$e(Object.assign(Object.assign({},this.bypassOptions),{doc:t,mutationCb:this.mutationCb,mirror:this.mirror,shadowDomManager:this}),e),tt(Object.assign(Object.assign({},this.bypassOptions),{scrollCb:this.scrollCb,doc:e,mirror:this.mirror})),setTimeout(()=>{e.adoptedStyleSheets&&0<e.adoptedStyleSheets.length&&this.bypassOptions.stylesheetManager.adoptStyleSheets(e.adoptedStyleSheets,this.mirror.getId(e.host)),st({mirror:this.mirror,stylesheetManager:this.bypassOptions.stylesheetManager},e)},0))}observeAttachShadow(r){if(r.contentWindow){const n=this;this.restorePatches.push(E(r.contentWindow.HTMLElement.prototype,"attachShadow",function(t){return function(e){e=t.call(this,e);return this.shadowRoot&&n.addShadowRoot(this.shadowRoot,r.contentDocument),e}}))}}reset(){this.restorePatches.forEach(e=>e()),this.shadowDoms=new WeakSet}}function ut(e,s,i,c){return new(i=i||Promise)(function(r,t){function n(e){try{a(c.next(e))}catch(e){t(e)}}function o(e){try{a(c.throw(e))}catch(e){t(e)}}function a(e){var t;e.done?r(e.value):((t=e.value)instanceof i?t:new i(function(e){e(t)})).then(n,o)}a((c=c.apply(e,s||[])).next())})}for(var a="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",ht="undefined"==typeof Uint8Array?[]:new Uint8Array(256),pt=0;pt<a.length;pt++)ht[a.charCodeAt(pt)]=pt;function gt(e){for(var t=new Uint8Array(e),r=t.length,n="",o=0;o<r;o+=3)n=(n=(n=(n+=a[t[o]>>2])+a[(3&t[o])<<4|t[o+1]>>4])+a[(15&t[o+1])<<2|t[o+2]>>6])+a[63&t[o+2]];return r%3==2?n=n.substring(0,n.length-1)+"=":r%3==1&&(n=n.substring(0,n.length-2)+"=="),n}const mt=new Map;const It=(t,r,n)=>{if(t&&(Ct(t,r)||"object"==typeof t)){r=function(e,t){let r=mt.get(e);return r||(r=new Map,mt.set(e,r)),r.has(t)||r.set(t,[]),r.get(t)}(n,t.constructor.name);let e=r.indexOf(t);return-1===e&&(e=r.length,r.push(t)),e}};const ft=(e,t,r)=>[...e].map(e=>function t(e,r,n){var o;return e instanceof Array?e.map(e=>t(e,r,n)):null===e?e:e instanceof Float32Array||e instanceof Float64Array||e instanceof Int32Array||e instanceof Uint32Array||e instanceof Uint8Array||e instanceof Uint16Array||e instanceof Int16Array||e instanceof Int8Array||e instanceof Uint8ClampedArray?{rr_type:e.constructor.name,args:[Object.values(e)]}:e instanceof ArrayBuffer?{rr_type:e.constructor.name,base64:gt(e)}:e instanceof DataView?{rr_type:e.constructor.name,args:[t(e.buffer,r,n),e.byteOffset,e.byteLength]}:e instanceof HTMLImageElement?(o=e.src,{rr_type:e.constructor.name,src:o}):e instanceof HTMLCanvasElement?{rr_type:"HTMLImageElement",src:e.toDataURL()}:e instanceof ImageData?{rr_type:e.constructor.name,args:[t(e.data,r,n),e.width,e.height]}:Ct(e,r)||"object"==typeof e?{rr_type:e.constructor.name,index:It(e,r,n)}:e}(e,t,r)),Ct=(t,r)=>{var e=["WebGLActiveInfo","WebGLBuffer","WebGLFramebuffer","WebGLProgram","WebGLRenderbuffer","WebGLShader","WebGLShaderPrecisionFormat","WebGLTexture","WebGLUniformLocation","WebGLVertexArrayObject","WebGLVertexArrayObjectOES"].filter(e=>"function"==typeof r[e]);return Boolean(e.find(e=>t instanceof r[e]))};function yt(e,n,o){const t=[];try{var r=E(e.HTMLCanvasElement.prototype,"getContext",function(r){return function(e,...t){return x(this,n,o,!0)||"__context"in this||(this.__context=e),r.apply(this,[e,...t])}});t.push(r)}catch(e){console.error("failed to patch HTMLCanvasElement.prototype.getContext")}return()=>{t.forEach(e=>e())}}function St(t,n,o,a,s,e,i){var r,c=[];for(const d of Object.getOwnPropertyNames(t))if(!["isContextLost","canvas","drawingBufferWidth","drawingBufferHeight"].includes(d))try{"function"==typeof t[d]&&(r=E(t,d,function(r){return function(...e){var t=r.apply(this,e);return It(t,i,this),x(this.canvas,a,s,!0)||(e=ft([...e],i,this),e={type:n,property:d,args:e},o(this.canvas,e)),t}}),c.push(r))}catch(e){var l=Ee(t,d,{set(e){o(this.canvas,{type:n,property:d,args:[e],setter:!0})}});c.push(l)}return c}var vt=null;try{vt=("undefined"!=typeof module&&"function"==typeof module.require&&module.require("worker_threads")||"function"==typeof __non_webpack_require__&&__non_webpack_require__("worker_threads")||"function"==typeof require&&require("worker_threads")).Worker}catch(e){}function bt(e,t,r){var t=void 0===t?null:t,e=(r=void 0!==r&&r,Buffer.from(e,"base64").toString(r?"utf16":"utf8")),r=e.indexOf("\n",10)+1,n=e.substring(r)+(t?"//# sourceMappingURL="+t:"");return function(e){return new vt(n,Object.assign({},e,{eval:!0}))}}function At(e,t,r){t=void 0===t?null:t,e=function(e,t){var r=atob(e);if(t){for(var n=new Uint8Array(r.length),o=0,a=r.length;o<a;++o)n[o]=r.charCodeAt(o);return String.fromCharCode.apply(null,new Uint16Array(n.buffer))}return r}(e,void 0!==r&&r),r=e.indexOf("\n",10)+1,e=e.substring(r)+(t?"//# sourceMappingURL="+t:""),r=new Blob([e],{type:"application/javascript"});return URL.createObjectURL(r)}var S="[object process]"===Object.prototype.toString.call("undefined"!=typeof process?process:0);o=null,kt=!(wt="Lyogcm9sbHVwLXBsdWdpbi13ZWItd29ya2VyLWxvYWRlciAqLwooZnVuY3Rpb24gKCkgewogICAgJ3VzZSBzdHJpY3QnOwoKICAgIC8qISAqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKg0KICAgIENvcHlyaWdodCAoYykgTWljcm9zb2Z0IENvcnBvcmF0aW9uLg0KDQogICAgUGVybWlzc2lvbiB0byB1c2UsIGNvcHksIG1vZGlmeSwgYW5kL29yIGRpc3RyaWJ1dGUgdGhpcyBzb2Z0d2FyZSBmb3IgYW55DQogICAgcHVycG9zZSB3aXRoIG9yIHdpdGhvdXQgZmVlIGlzIGhlcmVieSBncmFudGVkLg0KDQogICAgVEhFIFNPRlRXQVJFIElTIFBST1ZJREVEICJBUyBJUyIgQU5EIFRIRSBBVVRIT1IgRElTQ0xBSU1TIEFMTCBXQVJSQU5USUVTIFdJVEgNCiAgICBSRUdBUkQgVE8gVEhJUyBTT0ZUV0FSRSBJTkNMVURJTkcgQUxMIElNUExJRUQgV0FSUkFOVElFUyBPRiBNRVJDSEFOVEFCSUxJVFkNCiAgICBBTkQgRklUTkVTUy4gSU4gTk8gRVZFTlQgU0hBTEwgVEhFIEFVVEhPUiBCRSBMSUFCTEUgRk9SIEFOWSBTUEVDSUFMLCBESVJFQ1QsDQogICAgSU5ESVJFQ1QsIE9SIENPTlNFUVVFTlRJQUwgREFNQUdFUyBPUiBBTlkgREFNQUdFUyBXSEFUU09FVkVSIFJFU1VMVElORyBGUk9NDQogICAgTE9TUyBPRiBVU0UsIERBVEEgT1IgUFJPRklUUywgV0hFVEhFUiBJTiBBTiBBQ1RJT04gT0YgQ09OVFJBQ1QsIE5FR0xJR0VOQ0UgT1INCiAgICBPVEhFUiBUT1JUSU9VUyBBQ1RJT04sIEFSSVNJTkcgT1VUIE9GIE9SIElOIENPTk5FQ1RJT04gV0lUSCBUSEUgVVNFIE9SDQogICAgUEVSRk9STUFOQ0UgT0YgVEhJUyBTT0ZUV0FSRS4NCiAgICAqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKiAqLw0KDQogICAgZnVuY3Rpb24gX19hd2FpdGVyKHRoaXNBcmcsIF9hcmd1bWVudHMsIFAsIGdlbmVyYXRvcikgew0KICAgICAgICBmdW5jdGlvbiBhZG9wdCh2YWx1ZSkgeyByZXR1cm4gdmFsdWUgaW5zdGFuY2VvZiBQID8gdmFsdWUgOiBuZXcgUChmdW5jdGlvbiAocmVzb2x2ZSkgeyByZXNvbHZlKHZhbHVlKTsgfSk7IH0NCiAgICAgICAgcmV0dXJuIG5ldyAoUCB8fCAoUCA9IFByb21pc2UpKShmdW5jdGlvbiAocmVzb2x2ZSwgcmVqZWN0KSB7DQogICAgICAgICAgICBmdW5jdGlvbiBmdWxmaWxsZWQodmFsdWUpIHsgdHJ5IHsgc3RlcChnZW5lcmF0b3IubmV4dCh2YWx1ZSkpOyB9IGNhdGNoIChlKSB7IHJlamVjdChlKTsgfSB9DQogICAgICAgICAgICBmdW5jdGlvbiByZWplY3RlZCh2YWx1ZSkgeyB0cnkgeyBzdGVwKGdlbmVyYXRvclsidGhyb3ciXSh2YWx1ZSkpOyB9IGNhdGNoIChlKSB7IHJlamVjdChlKTsgfSB9DQogICAgICAgICAgICBmdW5jdGlvbiBzdGVwKHJlc3VsdCkgeyByZXN1bHQuZG9uZSA/IHJlc29sdmUocmVzdWx0LnZhbHVlKSA6IGFkb3B0KHJlc3VsdC52YWx1ZSkudGhlbihmdWxmaWxsZWQsIHJlamVjdGVkKTsgfQ0KICAgICAgICAgICAgc3RlcCgoZ2VuZXJhdG9yID0gZ2VuZXJhdG9yLmFwcGx5KHRoaXNBcmcsIF9hcmd1bWVudHMgfHwgW10pKS5uZXh0KCkpOw0KICAgICAgICB9KTsNCiAgICB9CgogICAgLyoKICAgICAqIGJhc2U2NC1hcnJheWJ1ZmZlciAxLjAuMSA8aHR0cHM6Ly9naXRodWIuY29tL25pa2xhc3ZoL2Jhc2U2NC1hcnJheWJ1ZmZlcj4KICAgICAqIENvcHlyaWdodCAoYykgMjAyMSBOaWtsYXMgdm9uIEhlcnR6ZW4gPGh0dHBzOi8vaGVydHplbi5jb20+CiAgICAgKiBSZWxlYXNlZCB1bmRlciBNSVQgTGljZW5zZQogICAgICovCiAgICB2YXIgY2hhcnMgPSAnQUJDREVGR0hJSktMTU5PUFFSU1RVVldYWVphYmNkZWZnaGlqa2xtbm9wcXJzdHV2d3h5ejAxMjM0NTY3ODkrLyc7CiAgICAvLyBVc2UgYSBsb29rdXAgdGFibGUgdG8gZmluZCB0aGUgaW5kZXguCiAgICB2YXIgbG9va3VwID0gdHlwZW9mIFVpbnQ4QXJyYXkgPT09ICd1bmRlZmluZWQnID8gW10gOiBuZXcgVWludDhBcnJheSgyNTYpOwogICAgZm9yICh2YXIgaSA9IDA7IGkgPCBjaGFycy5sZW5ndGg7IGkrKykgewogICAgICAgIGxvb2t1cFtjaGFycy5jaGFyQ29kZUF0KGkpXSA9IGk7CiAgICB9CiAgICB2YXIgZW5jb2RlID0gZnVuY3Rpb24gKGFycmF5YnVmZmVyKSB7CiAgICAgICAgdmFyIGJ5dGVzID0gbmV3IFVpbnQ4QXJyYXkoYXJyYXlidWZmZXIpLCBpLCBsZW4gPSBieXRlcy5sZW5ndGgsIGJhc2U2NCA9ICcnOwogICAgICAgIGZvciAoaSA9IDA7IGkgPCBsZW47IGkgKz0gMykgewogICAgICAgICAgICBiYXNlNjQgKz0gY2hhcnNbYnl0ZXNbaV0gPj4gMl07CiAgICAgICAgICAgIGJhc2U2NCArPSBjaGFyc1soKGJ5dGVzW2ldICYgMykgPDwgNCkgfCAoYnl0ZXNbaSArIDFdID4+IDQpXTsKICAgICAgICAgICAgYmFzZTY0ICs9IGNoYXJzWygoYnl0ZXNbaSArIDFdICYgMTUpIDw8IDIpIHwgKGJ5dGVzW2kgKyAyXSA+PiA2KV07CiAgICAgICAgICAgIGJhc2U2NCArPSBjaGFyc1tieXRlc1tpICsgMl0gJiA2M107CiAgICAgICAgfQogICAgICAgIGlmIChsZW4gJSAzID09PSAyKSB7CiAgICAgICAgICAgIGJhc2U2NCA9IGJhc2U2NC5zdWJzdHJpbmcoMCwgYmFzZTY0Lmxlbmd0aCAtIDEpICsgJz0nOwogICAgICAgIH0KICAgICAgICBlbHNlIGlmIChsZW4gJSAzID09PSAxKSB7CiAgICAgICAgICAgIGJhc2U2NCA9IGJhc2U2NC5zdWJzdHJpbmcoMCwgYmFzZTY0Lmxlbmd0aCAtIDIpICsgJz09JzsKICAgICAgICB9CiAgICAgICAgcmV0dXJuIGJhc2U2NDsKICAgIH07CgogICAgY29uc3QgbGFzdEJsb2JNYXAgPSBuZXcgTWFwKCk7DQogICAgY29uc3QgdHJhbnNwYXJlbnRCbG9iTWFwID0gbmV3IE1hcCgpOw0KICAgIGZ1bmN0aW9uIGdldFRyYW5zcGFyZW50QmxvYkZvcih3aWR0aCwgaGVpZ2h0LCBkYXRhVVJMT3B0aW9ucykgew0KICAgICAgICByZXR1cm4gX19hd2FpdGVyKHRoaXMsIHZvaWQgMCwgdm9pZCAwLCBmdW5jdGlvbiogKCkgew0KICAgICAgICAgICAgY29uc3QgaWQgPSBgJHt3aWR0aH0tJHtoZWlnaHR9YDsNCiAgICAgICAgICAgIGlmICgnT2Zmc2NyZWVuQ2FudmFzJyBpbiBnbG9iYWxUaGlzKSB7DQogICAgICAgICAgICAgICAgaWYgKHRyYW5zcGFyZW50QmxvYk1hcC5oYXMoaWQpKQ0KICAgICAgICAgICAgICAgICAgICByZXR1cm4gdHJhbnNwYXJlbnRCbG9iTWFwLmdldChpZCk7DQogICAgICAgICAgICAgICAgY29uc3Qgb2Zmc2NyZWVuID0gbmV3IE9mZnNjcmVlbkNhbnZhcyh3aWR0aCwgaGVpZ2h0KTsNCiAgICAgICAgICAgICAgICBvZmZzY3JlZW4uZ2V0Q29udGV4dCgnMmQnKTsNCiAgICAgICAgICAgICAgICBjb25zdCBibG9iID0geWllbGQgb2Zmc2NyZWVuLmNvbnZlcnRUb0Jsb2IoZGF0YVVSTE9wdGlvbnMpOw0KICAgICAgICAgICAgICAgIGNvbnN0IGFycmF5QnVmZmVyID0geWllbGQgYmxvYi5hcnJheUJ1ZmZlcigpOw0KICAgICAgICAgICAgICAgIGNvbnN0IGJhc2U2NCA9IGVuY29kZShhcnJheUJ1ZmZlcik7DQogICAgICAgICAgICAgICAgdHJhbnNwYXJlbnRCbG9iTWFwLnNldChpZCwgYmFzZTY0KTsNCiAgICAgICAgICAgICAgICByZXR1cm4gYmFzZTY0Ow0KICAgICAgICAgICAgfQ0KICAgICAgICAgICAgZWxzZSB7DQogICAgICAgICAgICAgICAgcmV0dXJuICcnOw0KICAgICAgICAgICAgfQ0KICAgICAgICB9KTsNCiAgICB9DQogICAgY29uc3Qgd29ya2VyID0gc2VsZjsNCiAgICB3b3JrZXIub25tZXNzYWdlID0gZnVuY3Rpb24gKGUpIHsNCiAgICAgICAgcmV0dXJuIF9fYXdhaXRlcih0aGlzLCB2b2lkIDAsIHZvaWQgMCwgZnVuY3Rpb24qICgpIHsNCiAgICAgICAgICAgIGlmICgnT2Zmc2NyZWVuQ2FudmFzJyBpbiBnbG9iYWxUaGlzKSB7DQogICAgICAgICAgICAgICAgY29uc3QgeyBpZCwgYml0bWFwLCB3aWR0aCwgaGVpZ2h0LCBkYXRhVVJMT3B0aW9ucyB9ID0gZS5kYXRhOw0KICAgICAgICAgICAgICAgIGNvbnN0IHRyYW5zcGFyZW50QmFzZTY0ID0gZ2V0VHJhbnNwYXJlbnRCbG9iRm9yKHdpZHRoLCBoZWlnaHQsIGRhdGFVUkxPcHRpb25zKTsNCiAgICAgICAgICAgICAgICBjb25zdCBvZmZzY3JlZW4gPSBuZXcgT2Zmc2NyZWVuQ2FudmFzKHdpZHRoLCBoZWlnaHQpOw0KICAgICAgICAgICAgICAgIGNvbnN0IGN0eCA9IG9mZnNjcmVlbi5nZXRDb250ZXh0KCcyZCcpOw0KICAgICAgICAgICAgICAgIGN0eC5kcmF3SW1hZ2UoYml0bWFwLCAwLCAwKTsNCiAgICAgICAgICAgICAgICBiaXRtYXAuY2xvc2UoKTsNCiAgICAgICAgICAgICAgICBjb25zdCBibG9iID0geWllbGQgb2Zmc2NyZWVuLmNvbnZlcnRUb0Jsb2IoZGF0YVVSTE9wdGlvbnMpOw0KICAgICAgICAgICAgICAgIGNvbnN0IHR5cGUgPSBibG9iLnR5cGU7DQogICAgICAgICAgICAgICAgY29uc3QgYXJyYXlCdWZmZXIgPSB5aWVsZCBibG9iLmFycmF5QnVmZmVyKCk7DQogICAgICAgICAgICAgICAgY29uc3QgYmFzZTY0ID0gZW5jb2RlKGFycmF5QnVmZmVyKTsNCiAgICAgICAgICAgICAgICBpZiAoIWxhc3RCbG9iTWFwLmhhcyhpZCkgJiYgKHlpZWxkIHRyYW5zcGFyZW50QmFzZTY0KSA9PT0gYmFzZTY0KSB7DQogICAgICAgICAgICAgICAgICAgIGxhc3RCbG9iTWFwLnNldChpZCwgYmFzZTY0KTsNCiAgICAgICAgICAgICAgICAgICAgcmV0dXJuIHdvcmtlci5wb3N0TWVzc2FnZSh7IGlkIH0pOw0KICAgICAgICAgICAgICAgIH0NCiAgICAgICAgICAgICAgICBpZiAobGFzdEJsb2JNYXAuZ2V0KGlkKSA9PT0gYmFzZTY0KQ0KICAgICAgICAgICAgICAgICAgICByZXR1cm4gd29ya2VyLnBvc3RNZXNzYWdlKHsgaWQgfSk7DQogICAgICAgICAgICAgICAgd29ya2VyLnBvc3RNZXNzYWdlKHsNCiAgICAgICAgICAgICAgICAgICAgaWQsDQogICAgICAgICAgICAgICAgICAgIHR5cGUsDQogICAgICAgICAgICAgICAgICAgIGJhc2U2NCwNCiAgICAgICAgICAgICAgICAgICAgd2lkdGgsDQogICAgICAgICAgICAgICAgICAgIGhlaWdodCwNCiAgICAgICAgICAgICAgICB9KTsNCiAgICAgICAgICAgICAgICBsYXN0QmxvYk1hcC5zZXQoaWQsIGJhc2U2NCk7DQogICAgICAgICAgICB9DQogICAgICAgICAgICBlbHNlIHsNCiAgICAgICAgICAgICAgICByZXR1cm4gd29ya2VyLnBvc3RNZXNzYWdlKHsgaWQ6IGUuZGF0YS5pZCB9KTsNCiAgICAgICAgICAgIH0NCiAgICAgICAgfSk7DQogICAgfTsKCn0pKCk7Cgo=");var wt,kt,Mt,Tt,Nt,Rt,Ot=S?bt(wt,o,kt):(Mt=wt,Tt=o,Nt=kt,function(e){return Rt=Rt||At(Mt,Tt,Nt),new Worker(Rt,e)});class Et{constructor(e){this.pendingCanvasMutations=new Map,this.rafStamps={latestId:0,invokeId:null},this.frozen=!1,this.locked=!1,this.processMutation=(e,t)=>{(this.rafStamps.invokeId&&this.rafStamps.latestId!==this.rafStamps.invokeId||!this.rafStamps.invokeId)&&(this.rafStamps.invokeId=this.rafStamps.latestId),this.pendingCanvasMutations.has(e)||this.pendingCanvasMutations.set(e,[]),this.pendingCanvasMutations.get(e).push(t)};var{sampling:t="all",win:r,blockClass:n,blockSelector:o,recordCanvas:a,dataURLOptions:s}=e;this.mutationCb=e.mutationCb,this.mirror=e.mirror,a&&"all"===t&&this.initCanvasMutationObserver(r,n,o),a&&"number"==typeof t&&this.initCanvasFPSObserver(t,r,n,o,{dataURLOptions:s})}reset(){this.pendingCanvasMutations.clear(),this.resetObservers&&this.resetObservers()}freeze(){this.frozen=!0}unfreeze(){this.frozen=!1}lock(){this.locked=!0}unlock(){this.locked=!1}initCanvasFPSObserver(e,r,n,o,a){const t=yt(r,n,o),s=new Map,i=new Ot,c=(i.onmessage=e=>{var t,r,n,o=e.data["id"];s.set(o,!1),"base64"in e.data&&({base64:e,type:t,width:r,height:n}=e.data,this.mutationCb({id:o,type:Ue["2D"],commands:[{property:"clearRect",args:[0,0,r,n]},{property:"drawImage",args:[{rr_type:"ImageBitmap",args:[{rr_type:"Blob",data:[{rr_type:"ArrayBuffer",base64:e}],type:t}]},0,0]}]}))},1e3/e);let l=0,d;const u=()=>{const t=[];return r.document.querySelectorAll("canvas").forEach(e=>{x(e,n,o,!0)||t.push(e)}),t},h=e=>{d=(l&&e-l<c||(l=e,u().forEach(n=>ut(this,void 0,void 0,function*(){var e,t,r=this.mirror.getId(n);s.get(r)||(s.set(r,!0),["webgl","webgl2"].includes(n.__context)&&!1===(null==(t=null==(e=n.getContext(n.__context))?void 0:e.getContextAttributes())?void 0:t.preserveDrawingBuffer)&&null!=e&&e.clear(e.COLOR_BUFFER_BIT),t=yield createImageBitmap(n),i.postMessage({id:r,bitmap:t,width:n.width,height:n.height,dataURLOptions:a.dataURLOptions},[t]))}))),requestAnimationFrame(h))};d=requestAnimationFrame(h),this.resetObservers=()=>{t(),cancelAnimationFrame(d)}}initCanvasMutationObserver(e,t,r){this.startRAFTimestamping(),this.startPendingCanvasMutationFlusher();const n=yt(e,t,r),o=function(r,n,o,a){const t=[];var e;for(const i of Object.getOwnPropertyNames(n.CanvasRenderingContext2D.prototype))try{"function"==typeof n.CanvasRenderingContext2D.prototype[i]&&(e=E(n.CanvasRenderingContext2D.prototype,i,function(e){return function(...t){return x(this.canvas,o,a,!0)||setTimeout(()=>{var e=ft([...t],n,this);r(this.canvas,{type:Ue["2D"],property:i,args:e})},0),e.apply(this,t)}}),t.push(e))}catch(e){var s=Ee(n.CanvasRenderingContext2D.prototype,i,{set(e){r(this.canvas,{type:Ue["2D"],property:i,args:[e],setter:!0})}});t.push(s)}return()=>{t.forEach(e=>e())}}(this.processMutation.bind(this),e,t,r),a=function(e,t,r,n){const o=[];return o.push(...St(t.WebGLRenderingContext.prototype,Ue.WebGL,e,r,n,0,t)),void 0!==t.WebGL2RenderingContext&&o.push(...St(t.WebGL2RenderingContext.prototype,Ue.WebGL2,e,r,n,0,t)),()=>{o.forEach(e=>e())}}(this.processMutation.bind(this),e,t,r,this.mirror);this.resetObservers=()=>{n(),o(),a()}}startPendingCanvasMutationFlusher(){requestAnimationFrame(()=>this.flushPendingCanvasMutations())}startRAFTimestamping(){const t=e=>{this.rafStamps.latestId=e,requestAnimationFrame(t)};requestAnimationFrame(t)}flushPendingCanvasMutations(){this.pendingCanvasMutations.forEach((e,t)=>{var r=this.mirror.getId(t);this.flushPendingCanvasMutationFor(t,r)}),requestAnimationFrame(()=>this.flushPendingCanvasMutations())}flushPendingCanvasMutationFor(e,t){var r,n;this.frozen||this.locked||(n=this.pendingCanvasMutations.get(e))&&-1!==t&&(r=n.map(e=>{var t=e,r=["type"],n={};for(a in t)Object.prototype.hasOwnProperty.call(t,a)&&r.indexOf(a)<0&&(n[a]=t[a]);if(null!=t&&"function"==typeof Object.getOwnPropertySymbols)for(var o=0,a=Object.getOwnPropertySymbols(t);o<a.length;o++)r.indexOf(a[o])<0&&Object.prototype.propertyIsEnumerable.call(t,a[o])&&(n[a[o]]=t[a[o]]);return n}),n=n[0]["type"],this.mutationCb({id:t,type:n,commands:r}),this.pendingCanvasMutations.delete(e))}}class Dt{constructor(e){this.trackedLinkElements=new WeakSet,this.styleMirror=new Be,this.mutationCb=e.mutationCb,this.adoptedStyleSheetCb=e.adoptedStyleSheetCb}attachLinkElement(e,t){"_cssText"in t.attributes&&this.mutationCb({adds:[],removes:[],texts:[],attributes:[{id:t.id,attributes:t.attributes}]}),this.trackLinkElement(e)}trackLinkElement(e){this.trackedLinkElements.has(e)||(this.trackedLinkElements.add(e),this.trackStylesheetInLinkElement(e))}adoptStyleSheets(e,t){if(0!==e.length){var r,n={id:t,styleIds:[]},o=[];for(const a of e){let e;this.styleMirror.has(a)?e=this.styleMirror.getId(a):(e=this.styleMirror.add(a),r=Array.from(a.rules||CSSRule),o.push({styleId:e,rules:r.map((e,t)=>({rule:le(e),index:t}))})),n.styleIds.push(e)}0<o.length&&(n.styles=o),this.adoptedStyleSheetCb(n)}}reset(){this.styleMirror.reset(),this.trackedLinkElements=new WeakSet}trackStylesheetInLinkElement(e){}}function X(e){return Object.assign(Object.assign({},e),{timestamp:Date.now()})}let P,xt,Ft,Lt=!1;const q=new de;function Wt(W={}){const{emit:n,checkoutEveryNms:o,checkoutEveryNth:a,blockClass:v="rr-block",blockSelector:b=null,ignoreClass:V="rr-ignore",maskTextClass:A="rr-mask",maskTextSelector:w=null,inlineStylesheet:k=!0,maskAllInputs:Z,maskInputOptions:e,slimDOMOptions:t,maskInputFn:r,maskTextFn:M,hooks:B,packFn:s,sampling:i={},dataURLOptions:T={},mousemoveWait:c,recordCanvas:N=!1,recordCrossOriginIframes:l=!1,userTriggeredOnInput:G=!1,collectFonts:U=!1,inlineImages:R=!1,plugins:d,keepIframeSrcFn:O=()=>!1,ignoreCSSAttributes:K=new Set([])}=W,u=!l||window.parent===window;let h=!1;if(!u)try{window.parent.document,h=!1}catch(e){h=!0}if(u&&!n)throw new Error("emit function is required");void 0!==c&&void 0===i.mousemove&&(i.mousemove=c),q.reset();const E=!0===Z?{color:!0,date:!0,"datetime-local":!0,email:!0,month:!0,number:!0,range:!0,search:!0,tel:!0,text:!0,time:!0,url:!0,week:!0,textarea:!0,select:!0,password:!0}:void 0!==e?e:{password:!0},D=!0===t||"all"===t?{script:!0,comment:!0,headFavicon:!0,headWhitespace:!0,headMetaSocial:!0,headMetaRobots:!0,headMetaHttpEquiv:!0,headMetaVerification:!0,headMetaAuthorship:"all"===t,headMetaDescKeywords:"all"===t}:t||{};!function(e=window){"NodeList"in e&&!e.NodeList.prototype.forEach&&(e.NodeList.prototype.forEach=Array.prototype.forEach),"DOMTokenList"in e&&!e.DOMTokenList.prototype.forEach&&(e.DOMTokenList.prototype.forEach=Array.prototype.forEach),Node.prototype.contains||(Node.prototype.contains=(...e)=>{let t=e[0];if(!(0 in e))throw new TypeError("1 argument is required");do{if(this===t)return!0}while(t=t&&t.parentNode);return!1})}();let p,g=0;const m=e=>{for(const t of d||[])t.eventProcessor&&(e=t.eventProcessor(e));return e=s?s(e):e},I=(P=(e,t)=>{var r;null==(r=Q[0])||!r.isFrozen()||e.type===z.FullSnapshot||e.type===z.IncrementalSnapshot&&e.data.source===j.Mutation||Q.forEach(e=>e.unfreeze()),u?null!==n&&void 0!==n&&n(m(e),t):h&&(r={type:"rrweb",event:m(e),isCheckout:t},window.parent.postMessage(r,"*")),e.type===z.FullSnapshot?(p=e,g=0):e.type!==z.IncrementalSnapshot||e.data.source===j.Mutation&&e.data.isAttachIframe||(g++,t=a&&g>=a,r=o&&e.timestamp-p.timestamp>o,(t||r)&&xt(!0))},e=>{P(X({type:z.IncrementalSnapshot,data:Object.assign({source:j.Mutation},e)}))}),Y=e=>P(X({type:z.IncrementalSnapshot,data:Object.assign({source:j.Scroll},e)})),_=e=>P(X({type:z.IncrementalSnapshot,data:Object.assign({source:j.CanvasMutation},e)}));const x=new Dt({mutationCb:I,adoptedStyleSheetCb:e=>P(X({type:z.IncrementalSnapshot,data:Object.assign({source:j.AdoptedStyleSheet},e)}))}),F=new lt({mirror:q,mutationCb:I,stylesheetManager:x,recordCrossOriginIframes:l,wrappedEmit:P});for(const f of d||[])f.getMirror&&f.getMirror({nodeMirror:q,crossOriginIframeMirror:F.crossOriginIframeMirror,crossOriginIframeStyleMirror:F.crossOriginIframeStyleMirror});Ft=new Et({recordCanvas:N,mutationCb:_,win:window,blockClass:v,blockSelector:b,mirror:q,sampling:i.canvas,dataURLOptions:T});const L=new dt({mutationCb:I,scrollCb:Y,bypassOptions:{blockClass:v,blockSelector:b,maskTextClass:A,maskTextSelector:w,inlineStylesheet:k,maskInputOptions:E,dataURLOptions:T,maskTextFn:M,maskInputFn:r,recordCanvas:N,inlineImages:R,sampling:i,slimDOMOptions:D,iframeManager:F,stylesheetManager:x,canvasManager:Ft,keepIframeSrcFn:O},mirror:q});xt=(e=!1)=>{P(X({type:z.Meta,data:{href:window.location.href,width:xe(),height:De()}}),e),x.reset(),Q.forEach(e=>e.lock()),e=document,t={mirror:q,blockClass:v,blockSelector:b,maskTextClass:A,maskTextSelector:w,inlineStylesheet:k,maskAllInputs:E,maskTextFn:M,slimDOM:D,dataURLOptions:T,recordCanvas:N,inlineImages:R,onSerialize:e=>{We(e,q)&&F.addIframe(e),Ve(e,q)&&x.trackLinkElement(e),Ze(e)&&L.addShadowRoot(e.shadowRoot,document)},onIframeLoad:(e,t)=>{F.attachIframe(e,t),L.observeAttachShadow(e)},onStylesheetLoad:(e,t)=>{x.attachLinkElement(e,t)},keepIframeSrcFn:O},r=void 0===(r=(t=t||{}).mirror)?new de:r,n=t.blockClass,o=t.blockSelector,a=t.maskTextClass,s=t.maskTextSelector,i=t.inlineStylesheet,c=t.inlineImages,l=t.recordCanvas,d=void 0!==(d=t.maskAllInputs)&&d,u=t.maskTextFn,h=t.maskInputFn,p=void 0!==(p=t.slimDOM)&&p,g=t.dataURLOptions,m=t.preserveWhiteSpace,I=t.onSerialize,f=t.onIframeLoad,C=t.iframeLoadTimeout,y=t.onStylesheetLoad,S=t.stylesheetLoadTimeout,t=t.keepIframeSrcFn;var t,r,n,o,a,s,i,c,l,d,u,h,p,g,m,I,f,C,y,S,e=J(e,{doc:e,mirror:r,blockClass:void 0===n?"rr-block":n,blockSelector:void 0===o?null:o,maskTextClass:void 0===a?"rr-mask":a,maskTextSelector:void 0===s?null:s,skipChild:!1,inlineStylesheet:void 0===i||i,maskInputOptions:!0===d?{color:!0,date:!0,"datetime-local":!0,email:!0,month:!0,number:!0,range:!0,search:!0,tel:!0,text:!0,time:!0,url:!0,week:!0,textarea:!0,select:!0,password:!0}:!1===d?{password:!0}:d,maskTextFn:u,maskInputFn:h,slimDOMOptions:!0===p||"all"===p?{script:!0,comment:!0,headFavicon:!0,headWhitespace:!0,headMetaDescKeywords:"all"===p,headMetaSocial:!0,headMetaRobots:!0,headMetaHttpEquiv:!0,headMetaAuthorship:!0,headMetaVerification:!0}:!1===p?{}:p,dataURLOptions:g,inlineImages:void 0!==c&&c,recordCanvas:void 0!==l&&l,preserveWhiteSpace:m,onSerialize:I,onIframeLoad:f,iframeLoadTimeout:C,onStylesheetLoad:y,stylesheetLoadTimeout:S,keepIframeSrcFn:void 0===t?function(){return!1}:t,newlyAddedElement:!1});if(!e)return console.warn("Failed to snapshot the document");P(X({type:z.FullSnapshot,data:{node:e,initialOffset:{left:void 0!==window.pageXOffset?window.pageXOffset:(null===document||void 0===document?void 0:document.documentElement.scrollLeft)||(null==(n=null==(r=null===document||void 0===document?void 0:document.body)?void 0:r.parentElement)?void 0:n.scrollLeft)||(null==(o=null===document||void 0===document?void 0:document.body)?void 0:o.scrollLeft)||0,top:void 0!==window.pageYOffset?window.pageYOffset:(null===document||void 0===document?void 0:document.documentElement.scrollTop)||(null==(s=null==(a=null===document||void 0===document?void 0:document.body)?void 0:a.parentElement)?void 0:s.scrollTop)||(null==(i=null===document||void 0===document?void 0:document.body)?void 0:i.scrollTop)||0}}})),Q.forEach(e=>e.unlock()),document.adoptedStyleSheets&&0<document.adoptedStyleSheets.length&&x.adoptStyleSheets(document.adoptedStyleSheets,q.getId(document))};try{const C=[],y=(C.push(H("DOMContentLoaded",()=>{P(X({type:z.DomContentLoaded,data:{}}))})),e=>{return it({mutationCb:I,mousemoveCb:(e,t)=>P(X({type:z.IncrementalSnapshot,data:{source:t,positions:e}})),mouseInteractionCb:e=>P(X({type:z.IncrementalSnapshot,data:Object.assign({source:j.MouseInteraction},e)})),scrollCb:Y,viewportResizeCb:e=>P(X({type:z.IncrementalSnapshot,data:Object.assign({source:j.ViewportResize},e)})),inputCb:e=>P(X({type:z.IncrementalSnapshot,data:Object.assign({source:j.Input},e)})),mediaInteractionCb:e=>P(X({type:z.IncrementalSnapshot,data:Object.assign({source:j.MediaInteraction},e)})),styleSheetRuleCb:e=>P(X({type:z.IncrementalSnapshot,data:Object.assign({source:j.StyleSheetRule},e)})),styleDeclarationCb:e=>P(X({type:z.IncrementalSnapshot,data:Object.assign({source:j.StyleDeclaration},e)})),canvasMutationCb:_,fontCb:e=>P(X({type:z.IncrementalSnapshot,data:Object.assign({source:j.Font},e)})),selectionCb:e=>{P(X({type:z.IncrementalSnapshot,data:Object.assign({source:j.Selection},e)}))},blockClass:v,ignoreClass:V,maskTextClass:A,maskTextSelector:w,maskInputOptions:E,inlineStylesheet:k,sampling:i,recordCanvas:N,inlineImages:R,userTriggeredOnInput:G,collectFonts:U,doc:e,maskInputFn:r,maskTextFn:M,keepIframeSrcFn:O,blockSelector:b,slimDOMOptions:D,dataURLOptions:T,mirror:q,iframeManager:F,stylesheetManager:x,shadowDomManager:L,canvasManager:Ft,ignoreCSSAttributes:K,plugins:(null==(e=null===d||void 0===d?void 0:d.filter(e=>e.observer))?void 0:e.map(t=>({observer:t.observer,options:t.options,callback:e=>P(X({type:z.Plugin,data:{plugin:t.name,payload:e}}))})))||[]},B)}),S=(F.addLoadListener(e=>{C.push(y(e.contentDocument))}),()=>{xt(),C.push(y(document)),Lt=!0});return"interactive"===document.readyState||"complete"===document.readyState?S():C.push(H("load",()=>{P(X({type:z.Load,data:{}})),S()},window)),()=>{C.forEach(e=>e()),Lt=!1}}catch(e){console.warn(e)}}Wt.addCustomEvent=(e,t)=>{if(!Lt)throw new Error("please add custom event after start recording");P(X({type:z.Custom,data:{tag:e,payload:t}}))},Wt.freezePage=()=>{Q.forEach(e=>e.freeze())},Wt.takeFullSnapshot=e=>{if(!Lt)throw new Error("please take full snapshot after start recording");xt(e)},Wt.mirror=q;const v=new class{constructor(){this.debug=!1,this.watchReady=!1,this.watchJsError=!1,this.watchSource=!1,this.watchAxios=!1,this.watchPerformance=!1,this.config=new Map,this.snapshot=[],this.stopFn=null,this.console("info","娆㈣繋浣跨敤銆恖og-reporting銆戞棩蹇椾笂鎶ョ郴缁�!")}init(t){return b(this,void 0,void 0,function*(){try{this.initRRWeb(),yield this.validateConfig(t)}catch(e){this.console("error",e.message,t)}this.watchReady&&window.addEventListener("load",_,!0),this.watchJsError&&(window.addEventListener("unhandledrejection",$),window.addEventListener("error",ee,!0)),this.watchAxios&&ae()})}initRRWeb(){const r=this;this.stopFn=Wt({emit(e,t){t&&(r.snapshot=[]),r.snapshot.push(e)},checkoutEveryNms:15e3})}validateConfig(n){return new Promise((e,t)=>{var r=Object.keys(n);return n&&r.length?(r.map(e=>this.setConfigValue(e,n)),this.setDebug(),this.setInternalVariable(n.config)?void e(!0):t({message:"璇疯缃甤onfig鍙傛暟!"})):t({message:"鍒濆鍖栧弬鏁伴敊璇�!"})})}setConfigValue(e,t){this.config.set(e,t[e])}getConfigValue(e){return this.config.get(e)}setDebug(){var e=this.getConfigValue("debug");"[object Boolean]"===Object.prototype.toString.call(e)?this.debug=e:this.debug=!0}setInternalVariable(t){return!(!t||!Object.keys(t).length||(Object.keys(t).map(e=>{this[e]=t[e]}),0))}console(e,t,r){"info"===e&&console.log("%c鏃ュ織涓婃姤绯荤粺SDK-ERROR====>"+` 鏃堕棿:${this.time()}  閿欒淇℃伅: `+(t||"-"),"background: #ecf5ff;color:#409eff;padding: 2px 4px;font-size: 12px;font-weight: 600;"),this.debug&&("log"===e?console.log("%c鏃ュ織涓婃姤绯荤粺SDK-LOG====>"+` 鏃堕棿:${this.time()}  閿欒淇℃伅: `+(t||"-"),"background: #f4f4f5;color:#909399;padding: 2px 4px;font-size: 12px;font-weight: 600;"):"warn"===e?console.log("%c鏃ュ織涓婃姤绯荤粺SDK-WARN====>"+` 鏃堕棿:${this.time()}  閿欒淇℃伅: `+(t||"-"),"background: #fdf6ec;color:#e6a23c;padding: 2px 4px;font-size: 12px;font-weight: 600;"):"error"===e&&console.log("%c鏃ュ織涓婃姤绯荤粺SDK-ERROR====>"+` 鏃堕棿:${this.time()}  閿欒淇℃伅: `+(t||"-"),"background: #fef0f0;color:#f56c6c;padding: 2px 4px;font-size: 12px;font-weight: 600;"),r)&&console.table(r)}time(e,t="YYYY-MM-DD HH:mm:ss"){return Z(e).format(t)}destroy(){window.monitorSdk=null,this.watchReady&&te("load"),this.watchJsError&&te("js"),window.fetch=oe,XMLHttpRequest.prototype.open=ne,XMLHttpRequest.prototype.send=re}};return window.logReporting=v});